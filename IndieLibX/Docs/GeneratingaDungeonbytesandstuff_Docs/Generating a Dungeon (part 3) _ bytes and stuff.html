<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) & !(IE 8)]><!-->
<html lang="en-US"><!--<![endif]--><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<title>Generating a Dungeon (part 3) | bytes and stuff</title>
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="pingback" href="http://trlewis.net/xmlrpc.php">
	<!--[if lt IE 9]>
	
	<![endif]-->
	<link rel="dns-prefetch" href="http://fonts.googleapis.com/">
<link rel="dns-prefetch" href="http://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="bytes and stuff » Feed" href="http://trlewis.net/feed/">
<link rel="alternate" type="application/rss+xml" title="bytes and stuff » Comments Feed" href="http://trlewis.net/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="bytes and stuff » Generating a Dungeon (part 3) Comments Feed" href="http://trlewis.net/generating-a-dungeon-part-3/feed/">
		
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="twentyfourteen-lato-css" href="Generating%20a%20Dungeon%20(part%203)%20|%20bytes%20and%20stuff_tiedostot/css.css" type="text/css" media="all">
<link rel="stylesheet" id="genericons-css" href="Generating%20a%20Dungeon%20(part%203)%20|%20bytes%20and%20stuff_tiedostot/genericons.css" type="text/css" media="all">
<link rel="stylesheet" id="twentyfourteen-style-css" href="Generating%20a%20Dungeon%20(part%203)%20|%20bytes%20and%20stuff_tiedostot/style.css" type="text/css" media="all">
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentyfourteen-ie-css'  href='http://trlewis.net/wp-content/themes/twentyfourteen/css/ie.css?ver=20131205' type='text/css' media='all' />
<![endif]-->


<link rel="https://api.w.org/" href="http://trlewis.net/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://trlewis.net/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://trlewis.net/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Generating a Dungeon (part 2)" href="http://trlewis.net/generation-a-dungeon-part-2/">
<link rel="next" title="Working with a 7-segment display" href="http://trlewis.net/working-with-a-7-segment-display/">
<meta name="generator" content="WordPress 4.7.10">
<link rel="canonical" href="http://trlewis.net/generating-a-dungeon-part-3/">
<link rel="shortlink" href="http://trlewis.net/?p=151">
<link rel="alternate" type="application/json+oembed" href="http://trlewis.net/wp-json/oembed/1.0/embed?url=http%3A%2F%2Ftrlewis.net%2Fgenerating-a-dungeon-part-3%2F">
<link rel="alternate" type="text/xml+oembed" href="http://trlewis.net/wp-json/oembed/1.0/embed?url=http%3A%2F%2Ftrlewis.net%2Fgenerating-a-dungeon-part-3%2F&amp;format=xml">
		<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
		<style type="text/css">
/* <![CDATA[ */
img.latex { vertical-align: middle; border: none; }
/* ]]> */
</style>
<style type="text/css" id="custom-background-css">
body.custom-background { background-image: url("http://trlewis.net/wp-content/uploads/2014/11/bgpattern.png"); background-position: left top; background-size: auto; background-repeat: repeat; background-attachment: scroll; }
</style>
<link rel="stylesheet" type="text/css" href="Generating%20a%20Dungeon%20(part%203)%20|%20bytes%20and%20stuff_tiedostot/shCore.css"><link rel="stylesheet" type="text/css" href="Generating%20a%20Dungeon%20(part%203)%20|%20bytes%20and%20stuff_tiedostot/shThemeDefault.css"><style type="text/css" id="syntaxhighlighteranchor"></style>
</head>

<body class="post-template-default single single-post postid-151 single-format-standard custom-background masthead-fixed full-width singular">
<div id="page" class="hfeed site">
	
	<header id="masthead" class="site-header" role="banner">
		<div class="header-main">
			<h1 class="site-title"><a href="http://trlewis.net/" rel="home">bytes and stuff</a></h1>

			<div class="search-toggle">
				<a href="#search-container" class="screen-reader-text" aria-expanded="false" aria-controls="search-container">Search</a>
			</div>

			<nav id="primary-navigation" class="site-navigation primary-navigation" role="navigation">
				<button class="menu-toggle">Primary Menu</button>
				<a class="screen-reader-text skip-link" href="#content">Skip to content</a>
				<div class="menu-headermenu-container"><ul id="primary-menu" class="nav-menu"><li id="menu-item-109" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-109"><a href="http://trlewis.net/about/">Contact</a></li>
</ul></div>			</nav>
		</div>

		<div id="search-container" class="search-box-wrapper hide">
			<div class="search-box">
				<form role="search" method="get" class="search-form" action="http://trlewis.net/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input class="search-field" placeholder="Search …" name="s" type="search">
				</label>
				<input class="search-submit" value="Search" type="submit">
			</form>			</div>
		</div>
	</header><!-- #masthead -->

	<div id="main" class="site-main">

	<div id="primary" class="content-area">
		<div id="content" class="site-content" role="main">
			
<article id="post-151" class="post-151 post type-post status-publish format-standard hentry category-game-dev category-programming tag-cpp tag-sfml">
	
	<header class="entry-header">
				<div class="entry-meta">
			<span class="cat-links"><a href="http://trlewis.net/category/game-dev/" rel="category tag">Game Dev</a>, <a href="http://trlewis.net/category/programming/" rel="category tag">Programming</a></span>
		</div>
		<h1 class="entry-title">Generating a Dungeon (part 3)</h1>
		<div class="entry-meta">
			<span class="entry-date"><a href="http://trlewis.net/generating-a-dungeon-part-3/" rel="bookmark"><time class="entry-date" datetime="2014-12-19T14:47:01+00:00">December 19, 2014</time></a></span> <span class="byline"><span class="author vcard"><a class="url fn n" href="http://trlewis.net/author/econobeing/" rel="author">Travis</a></span></span>			<span class="comments-link"><a href="http://trlewis.net/generating-a-dungeon-part-3/#respond">Leave a comment</a></span>
					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>When I last left off I had the rooms (or data equivalent of rooms) 
created, the last thing that needed to be done was add in cycles so that
 the dungeon layout is not a tree. That’s what I’ll be tackling in this 
post.</p>
<p>I’ve updated the <code>generateMap()</code> function and added a call to the new function <code>fixTree()</code> at the end:</p>
<p><strong><code>fixTree()</code></strong></p>
<div><div id="highlighter_789880" class="syntaxhighlighter collapsed  cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div><div class="line number84 index83 alt1">84</div><div class="line number85 index84 alt2">85</div><div class="line number86 index85 alt1">86</div><div class="line number87 index86 alt2">87</div><div class="line number88 index87 alt1">88</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp keyword bold">void</code> <code class="cpp plain">GeneratedMap::fixTree()</code></div><div class="line number2 index1 alt1"><code class="cpp plain">{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//get all dead ends</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">std::vector&lt;Room*&gt; deadEnds;</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code> <code class="cpp plain">(unsigned </code><code class="cpp color1 bold">int</code> <code class="cpp plain">i = 0; i &lt; rooms.size(); i++)</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(rooms[i]-&gt;isDeadEnd())</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">deadEnds.push_back(rooms[i]);</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">std::random_shuffle(deadEnds.begin(), deadEnds.end());</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">unsigned </code><code class="cpp color1 bold">int</code> <code class="cpp plain">i = 0;</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">addedCount = 0;</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">cyclesToAdd = (deadEnds.size() * CYCLE_PERCENT) / 100;</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//keep adding cycles until the quantity is met or we run out of</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//dead ends to try</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code> <code class="cpp plain">(i &lt; deadEnds.size() &amp;&amp; addedCount &lt; cyclesToAdd)</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Room* de = deadEnds[i++];</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">std::vector&lt;Room*&gt; adjacentRooms = getAdjacentRooms(de);</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(adjacentRooms.size() &lt;= 0)</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">adjacentRooms.clear();</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">continue</code><code class="cpp plain">;</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">std::random_shuffle(adjacentRooms.begin(), adjacentRooms.end());</code></div><div class="line number27 index26 alt2">&nbsp;</div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">unsigned </code><code class="cpp color1 bold">int</code> <code class="cpp plain">j = 0;</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Room* aj = </code><code class="cpp keyword bold">nullptr</code><code class="cpp plain">;</code></div><div class="line number30 index29 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//find first non-connected room</code></div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">do</code></div><div class="line number32 index31 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number33 index32 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(!de-&gt;areConnected(adjacentRooms[j]))</code></div><div class="line number34 index33 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">aj = adjacentRooms[j];</code></div><div class="line number35 index34 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">j++;</code></div><div class="line number36 index35 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">} </code><code class="cpp keyword bold">while</code> <code class="cpp plain">(j &lt; adjacentRooms.size() &amp;&amp; aj == </code><code class="cpp keyword bold">nullptr</code><code class="cpp plain">);</code></div><div class="line number37 index36 alt2">&nbsp;</div><div class="line number38 index37 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//if no non-connected room is found try the next dead-end</code></div><div class="line number39 index38 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(aj == </code><code class="cpp keyword bold">nullptr</code><code class="cpp plain">)</code></div><div class="line number40 index39 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number41 index40 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">adjacentRooms.clear();</code></div><div class="line number42 index41 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">continue</code><code class="cpp plain">;</code></div><div class="line number43 index42 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number44 index43 alt1">&nbsp;</div><div class="line number45 index44 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">aj-&gt;hasSecondEntrance = </code><code class="cpp keyword bold">true</code><code class="cpp plain">;</code></div><div class="line number46 index45 alt1">&nbsp;</div><div class="line number47 index46 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//rooms are adjacent, but not connected, now we connect them... with</code></div><div class="line number48 index47 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//wizardry...</code></div><div class="line number49 index48 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">directionOfOther = de-&gt;directionOfOtherRoom(aj);</code></div><div class="line number50 index49 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">miny = 0, minx = 0, shift = 0;</code></div><div class="line number51 index50 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(directionOfOther == Room::LEFT || directionOfOther == Room::RIGHT)</code></div><div class="line number52 index51 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number53 index52 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">miny = std::max(de-&gt;topLeft.y, aj-&gt;topLeft.y);</code></div><div class="line number54 index53 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">maxy = std::min(de-&gt;bottomRight.y, aj-&gt;bottomRight.y);</code></div><div class="line number55 index54 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">dy = std::</code><code class="cpp functions bold">abs</code><code class="cpp plain">(maxy - miny);</code></div><div class="line number56 index55 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">shift = dy &lt;= 0 ? 0 : </code><code class="cpp functions bold">rand</code><code class="cpp plain">() % (dy + 1);</code></div><div class="line number57 index56 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number58 index57 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">else</code> <code class="cpp keyword bold">if</code> <code class="cpp plain">(directionOfOther == Room::UP || directionOfOther == Room::DOWN)</code></div><div class="line number59 index58 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number60 index59 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">minx = std::max(de-&gt;topLeft.x, aj-&gt;topLeft.x);</code></div><div class="line number61 index60 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">maxx = std::min(de-&gt;bottomRight.x, aj-&gt;bottomRight.x);</code></div><div class="line number62 index61 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">dx = std::</code><code class="cpp functions bold">abs</code><code class="cpp plain">(maxx - minx);</code></div><div class="line number63 index62 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">shift = dx &lt;= 0 ? 0 : </code><code class="cpp functions bold">rand</code><code class="cpp plain">() % (dx + 1);</code></div><div class="line number64 index63 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number65 index64 alt2">&nbsp;</div><div class="line number66 index65 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">switch</code> <code class="cpp plain">(directionOfOther)</code></div><div class="line number67 index66 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number68 index67 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code> <code class="cpp plain">Room::LEFT:</code></div><div class="line number69 index68 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">aj-&gt;startingCell2 = Vector2i(aj-&gt;bottomRight.x, miny + shift);</code></div><div class="line number70 index69 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">aj-&gt;previousCell2 = Vector2i(de-&gt;topLeft.x, miny + shift);</code></div><div class="line number71 index70 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number72 index71 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code> <code class="cpp plain">Room::RIGHT:</code></div><div class="line number73 index72 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">aj-&gt;startingCell2 = Vector2i(aj-&gt;topLeft.x, miny + shift);</code></div><div class="line number74 index73 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">aj-&gt;previousCell2 = Vector2i(de-&gt;bottomRight.x, miny + shift);</code></div><div class="line number75 index74 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number76 index75 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code> <code class="cpp plain">Room::UP:</code></div><div class="line number77 index76 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">aj-&gt;startingCell2 = Vector2i(minx + shift, aj-&gt;bottomRight.y);</code></div><div class="line number78 index77 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">aj-&gt;previousCell2 = Vector2i(minx + shift, de-&gt;topLeft.y);</code></div><div class="line number79 index78 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number80 index79 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code> <code class="cpp plain">Room::DOWN:</code></div><div class="line number81 index80 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">aj-&gt;startingCell2 = Vector2i(minx + shift, aj-&gt;topLeft.y);</code></div><div class="line number82 index81 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">aj-&gt;previousCell2 = Vector2i(minx + shift, de-&gt;bottomRight.y);</code></div><div class="line number83 index82 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number84 index83 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number85 index84 alt2">&nbsp;</div><div class="line number86 index85 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">addedCount++;</code></div><div class="line number87 index86 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number88 index87 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p><span id="more-151"></span></p>
<p>The method that’s called before that, <code>fillRooms()</code> adds 
in all the rooms and their connections. It uses a “flood fill” type 
algorithm to fill the dungeon with rooms. An individual room has four 
named pointers to child rooms that spawn from it: <code>left, right, bottom,</code> and <code>top</code>. Consequently we can detect when a room is a dead end by checking if all of its child pointers are null:</p>
<div><div id="highlighter_269427" class="syntaxhighlighter  cpp"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">bool</code> <code class="cpp plain">Room::isDeadEnd()</code></div><div class="line number2 index1 alt1"><code class="cpp plain">{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">!left &amp;&amp; !right &amp;&amp; !bottom &amp;&amp; !top;</code></div><div class="line number4 index3 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>This is what the <code>fixTree()</code> function starts with, a list of dead ends:</p>
<div><div id="highlighter_447688" class="syntaxhighlighter  cpp"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">//get all dead ends</code></div><div class="line number2 index1 alt1"><code class="cpp plain">std::vector&lt;Room*&gt; deadEnds;</code></div><div class="line number3 index2 alt2"><code class="cpp keyword bold">for</code> <code class="cpp plain">(unsigned </code><code class="cpp color1 bold">int</code> <code class="cpp plain">i = 0; i &lt; rooms.size(); i++)</code></div><div class="line number4 index3 alt1"><code class="cpp plain">{</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(rooms[i]-&gt;isDeadEnd())</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">deadEnds.push_back(rooms[i]);</code></div><div class="line number7 index6 alt2"><code class="cpp plain">}</code></div><div class="line number8 index7 alt1"><code class="cpp plain">std::random_shuffle(deadEnds.begin(), deadEnds.end());</code></div></div></td></tr></tbody></table></div></div>
<p>The plan here is to take this list of dead-ends and for a certain 
percent of them (in my code I used 50%), try to find an adjacent room 
that isn’t connected to it, then connect the two. In the code I added <code>startingCell2</code> and <code>previousCell2</code> to the <code>Room</code> class. These values are assigned on the adjacent room.</p>
<p>After finding the dead-ends, we set up the conditions for iterating through them:</p>
<div><div id="highlighter_155727" class="syntaxhighlighter  cpp"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">unsigned </code><code class="cpp color1 bold">int</code> <code class="cpp plain">j = 0;</code></div><div class="line number2 index1 alt1"><code class="cpp color1 bold">int</code> <code class="cpp plain">addedCount = 0;</code></div><div class="line number3 index2 alt2"><code class="cpp color1 bold">int</code> <code class="cpp plain">cyclesToAdd = (deadEnds.size() * CYCLE_PERCENT) / 100;</code></div><div class="line number4 index3 alt1"><code class="cpp comments">//keep adding cycles until the quantity is met or we run out of</code></div><div class="line number5 index4 alt2"><code class="cpp comments">//dead ends to try</code></div><div class="line number6 index5 alt1"><code class="cpp keyword bold">while</code> <code class="cpp plain">(j &lt; deadEnds.size() &amp;&amp; addedCount &lt; cyclesToAdd)</code></div><div class="line number7 index6 alt2"><code class="cpp plain">{</code></div></div></td></tr></tbody></table></div></div>
<p>For each dead-end we’re iterating through, start by getting a list of all adjacent rooms (non-diagonal):</p>
<div><div id="highlighter_723510" class="syntaxhighlighter  cpp"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">Room* de = deadEnds[j++];</code></div><div class="line number2 index1 alt1"><code class="cpp plain">std::vector&lt;Room*&gt; adjacentRooms = getAdjacentRooms(de);</code></div><div class="line number3 index2 alt2"><code class="cpp keyword bold">if</code> <code class="cpp plain">(adjacentRooms.size() &lt;= 0)</code></div><div class="line number4 index3 alt1"><code class="cpp plain">{</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">adjacentRooms.clear();</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">continue</code><code class="cpp plain">;</code></div><div class="line number7 index6 alt2"><code class="cpp plain">}</code></div><div class="line number8 index7 alt1"><code class="cpp plain">std::random_shuffle(adjacentRooms.begin(), adjacentRooms.end());</code></div></div></td></tr></tbody></table></div></div>
<p>The <code>getAdjacentRooms()</code> function creates a list of <code>Room</code>
 pointers, then looks at all the cells along the left, right, top, and 
bottom side of the dead-end room in order, and adds all the rooms 
occupying those cells into that list. I thought this function would be a
 good place to try out lambdas that were added in C++11. I’m familiar 
with C# lambdas and callbacks, but haven’t used them in C++ until now. 
The code I put inside of it needed to be used in four different places 
in the <code>getAdjacentRooms()</code> function, but it didn’t feel like it warranted its own function.</p>
<p><strong><code>getAdjacentRooms()</code></strong></p>
<div><div id="highlighter_474785" class="syntaxhighlighter collapsed  cpp"><div class="toolbar"><span><a href="#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">std::vector&lt;Room*&gt; GeneratedMap::getAdjacentRooms(Room* room)</code></div><div class="line number2 index1 alt1"><code class="cpp plain">{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">std::vector&lt;Room*&gt; adjacentRooms;</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//a lambda that will make the code below shorter</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//it checks if the given room is not null, if it isn't, adds the given</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//room to the roomsToCheck vector.</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">auto</code> <code class="cpp plain">addRoomToCollection = [&amp;adjacentRooms](Room* room) </code><code class="cpp keyword bold">mutable</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">-&gt; </code><code class="cpp keyword bold">void</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(room == </code><code class="cpp keyword bold">nullptr</code><code class="cpp plain">)</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code><code class="cpp plain">;</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">bool</code> <code class="cpp plain">found = </code><code class="cpp keyword bold">false</code><code class="cpp plain">;</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code> <code class="cpp plain">(</code><code class="cpp color1 bold">int</code> <code class="cpp plain">i = 0; i &lt; adjacentRooms.size(); i++)</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(adjacentRooms[i] == room)</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">found = </code><code class="cpp keyword bold">true</code><code class="cpp plain">;</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number23 index22 alt2">&nbsp;</div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(!found)</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">adjacentRooms.push_back(room);</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">};</code></div><div class="line number27 index26 alt2">&nbsp;</div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//rooms to left</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(room-&gt;topLeft.x &gt; 0)</code></div><div class="line number30 index29 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">x = room-&gt;topLeft.x - 1;</code></div><div class="line number32 index31 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code> <code class="cpp plain">(</code><code class="cpp color1 bold">int</code> <code class="cpp plain">y = room-&gt;topLeft.y; y &lt;= room-&gt;bottomRight.y; y++)</code></div><div class="line number33 index32 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">addRoomToCollection(getRoomFromCell(x, y));</code></div><div class="line number34 index33 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number35 index34 alt2">&nbsp;</div><div class="line number36 index35 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//rooms to right</code></div><div class="line number37 index36 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(room-&gt;bottomRight.x &lt; myWidth - 1)</code></div><div class="line number38 index37 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number39 index38 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">x = room-&gt;bottomRight.x + 1;</code></div><div class="line number40 index39 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code> <code class="cpp plain">(</code><code class="cpp color1 bold">int</code> <code class="cpp plain">y = room-&gt;topLeft.y; y &lt;= room-&gt;bottomRight.y; y++)</code></div><div class="line number41 index40 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">addRoomToCollection(getRoomFromCell(x, y));</code></div><div class="line number42 index41 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number43 index42 alt2">&nbsp;</div><div class="line number44 index43 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//rooms to top</code></div><div class="line number45 index44 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(room-&gt;topLeft.y &gt; 0)</code></div><div class="line number46 index45 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number47 index46 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">y = room-&gt;topLeft.y - 1;</code></div><div class="line number48 index47 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code> <code class="cpp plain">(</code><code class="cpp color1 bold">int</code> <code class="cpp plain">x = room-&gt;topLeft.x; x &lt;= room-&gt;bottomRight.x; x++)</code></div><div class="line number49 index48 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">addRoomToCollection(getRoomFromCell(x, y));</code></div><div class="line number50 index49 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number51 index50 alt2">&nbsp;</div><div class="line number52 index51 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//rooms to bottom</code></div><div class="line number53 index52 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(room-&gt;bottomRight.y &lt; myHeight - 1)</code></div><div class="line number54 index53 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number55 index54 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">y = room-&gt;bottomRight.y + 1;</code></div><div class="line number56 index55 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code> <code class="cpp plain">(</code><code class="cpp color1 bold">int</code> <code class="cpp plain">x = room-&gt;topLeft.x; x &lt;= room-&gt;bottomRight.x; x++)</code></div><div class="line number57 index56 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">addRoomToCollection(getRoomFromCell(x, y));</code></div><div class="line number58 index57 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number59 index58 alt2">&nbsp;</div><div class="line number60 index59 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">adjacentRooms;</code></div><div class="line number61 index60 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Back in the while loop of the <code>fixTree()</code> function, after 
the list of adjacent rooms is created, we try to find the first room in 
the list that’s not already connected to the dead-end. If we do find 
one, mark that room as having a second entrance, otherwise move on to 
the next dead-end:</p>
<div><div id="highlighter_441111" class="syntaxhighlighter  cpp"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">unsigned </code><code class="cpp color1 bold">int</code> <code class="cpp plain">j = 0;</code></div><div class="line number2 index1 alt1"><code class="cpp plain">Room* aj = </code><code class="cpp keyword bold">nullptr</code><code class="cpp plain">;</code></div><div class="line number3 index2 alt2"><code class="cpp comments">//find first non-connected room</code></div><div class="line number4 index3 alt1"><code class="cpp keyword bold">do</code></div><div class="line number5 index4 alt2"><code class="cpp plain">{</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(!de-&gt;areConnected(adjacentRooms[j]))</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">aj = adjacentRooms[j];</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">j++;</code></div><div class="line number9 index8 alt2"><code class="cpp plain">} </code><code class="cpp keyword bold">while</code> <code class="cpp plain">(j &lt; adjacentRooms.size() &amp;&amp; aj == </code><code class="cpp keyword bold">nullptr</code><code class="cpp plain">);</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="cpp comments">//if no non-connected room is found try the next dead-end</code></div><div class="line number12 index11 alt1"><code class="cpp keyword bold">if</code> <code class="cpp plain">(aj == </code><code class="cpp keyword bold">nullptr</code><code class="cpp plain">)</code></div><div class="line number13 index12 alt2"><code class="cpp plain">{</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">adjacentRooms.clear();</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">continue</code><code class="cpp plain">;</code></div><div class="line number16 index15 alt1"><code class="cpp plain">}</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="cpp plain">aj-&gt;hasSecondEntrance = </code><code class="cpp keyword bold">true</code><code class="cpp plain">;</code></div></div></td></tr></tbody></table></div></div>
<p>The <code>areConnected()</code> function checks the Room pointers on 
both rooms and makes sure that none of them are the other room in 
question. That explanation is terrible, so here’s the code:</p>
<div><div id="highlighter_632790" class="syntaxhighlighter  cpp"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">bool</code> <code class="cpp plain">Room::areConnected(Room* other)</code></div><div class="line number2 index1 alt1"><code class="cpp plain">{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//this function got long during debugging, decided to keep it that way</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">bool</code> <code class="cpp plain">lefta = left != </code><code class="cpp keyword bold">nullptr</code> <code class="cpp plain">&amp;&amp; left == other;</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">bool</code> <code class="cpp plain">righta = right != </code><code class="cpp keyword bold">nullptr</code> <code class="cpp plain">&amp;&amp; right == other;</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">bool</code> <code class="cpp plain">topa = top != </code><code class="cpp keyword bold">nullptr</code> <code class="cpp plain">&amp;&amp; top == other;</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">bool</code> <code class="cpp plain">bottoma = bottom != </code><code class="cpp keyword bold">nullptr</code> <code class="cpp plain">&amp;&amp; bottom == other;</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(lefta || righta || topa || bottoma)</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp keyword bold">true</code><code class="cpp plain">;</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">bool</code> <code class="cpp plain">leftb = other-&gt;left != </code><code class="cpp keyword bold">nullptr</code> <code class="cpp plain">&amp;&amp; other-&gt;left == </code><code class="cpp keyword bold">this</code><code class="cpp plain">;</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">bool</code> <code class="cpp plain">rightb = other-&gt;right != </code><code class="cpp keyword bold">nullptr</code> <code class="cpp plain">&amp;&amp; other-&gt;right == </code><code class="cpp keyword bold">this</code><code class="cpp plain">;</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">bool</code> <code class="cpp plain">topb = other-&gt;top != </code><code class="cpp keyword bold">nullptr</code> <code class="cpp plain">&amp;&amp; other-&gt;top == </code><code class="cpp keyword bold">this</code><code class="cpp plain">;</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">bool</code> <code class="cpp plain">bottomb = other-&gt;bottom != </code><code class="cpp keyword bold">nullptr</code> <code class="cpp plain">&amp;&amp; other-&gt;bottom == </code><code class="cpp keyword bold">this</code><code class="cpp plain">;</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(leftb || rightb || topb || bottomb)</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp keyword bold">true</code><code class="cpp plain">;</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp keyword bold">false</code><code class="cpp plain">;</code></div><div class="line number20 index19 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>If a non-connected adjacent room has been found and marked as having a
 second entrance, we then figure out what the x and y values are for <code>previousCell2</code> and <code>startingCell2</code> for that room. First we figure out the direction of that room.</p>
<div><div id="highlighter_237386" class="syntaxhighlighter  cpp"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">int</code> <code class="cpp plain">Room::directionOfOtherRoom(Room* other)</code></div><div class="line number2 index1 alt1"><code class="cpp plain">{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(other-&gt;bottomRight.x &lt; topLeft.x)</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">LEFT;</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(other-&gt;bottomRight.y &lt; topLeft.y)</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">UP;</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(other-&gt;topLeft.x &gt; bottomRight.x)</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">RIGHT;</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(other-&gt;topLeft.y &gt; bottomRight.y)</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">DOWN;</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">0;</code></div><div class="line number16 index15 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>We then need to decide where this entrance is going to be placed, this is done with the following code:</p>
<div><div id="highlighter_716381" class="syntaxhighlighter  cpp"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">int</code> <code class="cpp plain">directionOfOther = de-&gt;directionOfOtherRoom(aj);</code></div><div class="line number2 index1 alt1"><code class="cpp color1 bold">int</code> <code class="cpp plain">miny = 0, minx = 0, shift = 0;</code></div><div class="line number3 index2 alt2"><code class="cpp keyword bold">if</code> <code class="cpp plain">(directionOfOther == Room::LEFT || directionOfOther == Room::RIGHT)</code></div><div class="line number4 index3 alt1"><code class="cpp plain">{</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">miny = std::max(de-&gt;topLeft.y, aj-&gt;topLeft.y);</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">maxy = std::min(de-&gt;bottomRight.y, aj-&gt;bottomRight.y);</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">dy = std::</code><code class="cpp functions bold">abs</code><code class="cpp plain">(maxy - miny);</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">shift = </code><code class="cpp functions bold">rand</code><code class="cpp plain">() % (dy + 1);</code></div><div class="line number9 index8 alt2"><code class="cpp plain">}</code></div><div class="line number10 index9 alt1"><code class="cpp keyword bold">else</code> <code class="cpp keyword bold">if</code> <code class="cpp plain">(directionOfOther == Room::UP || directionOfOther == Room::DOWN)</code></div><div class="line number11 index10 alt2"><code class="cpp plain">{</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">minx = std::max(de-&gt;topLeft.x, aj-&gt;topLeft.x);</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">maxx = std::min(de-&gt;bottomRight.x, aj-&gt;bottomRight.x);</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">dx = std::</code><code class="cpp functions bold">abs</code><code class="cpp plain">(maxx - minx);</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">shift = </code><code class="cpp functions bold">rand</code><code class="cpp plain">() % (dx + 1);</code></div><div class="line number16 index15 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Now the above code looks kind of cryptic, so I’ll go into more detail about what it does.</p>
<p>It finds the range of cells that the entrance can be placed in and 
picks a value. For example, if rooms are next to each other on the left 
and right, there are three scenarios:</p>
<p><a href="http://trlewis.net/wp-content/uploads/2014/12/connection_scenarios.png"><img src="Generating%20a%20Dungeon%20(part%203)%20|%20bytes%20and%20stuff_tiedostot/connection_scenarios.png" alt="connection_scenarios" class="alignnone size-full wp-image-165" width="169" height="274"></a></p>
<p>A) The two room’s top and bottom cells line up exactly.<br>
B) The top/bottom cells of one room are inside the top/bottom cells of another<br>
C) The two rooms partially overlap, so that each has Y axis cells that don’t line up with the other.</p>
<p>What we need to do is find a “safe range” of Y axis values that are in both rooms. This is what <code>miny</code> and <code>maxy</code> are used for:</p>
<p><a href="http://trlewis.net/wp-content/uploads/2014/12/miny_maxy.png"><img src="Generating%20a%20Dungeon%20(part%203)%20|%20bytes%20and%20stuff_tiedostot/miny_maxy.png" alt="miny_maxy" class="alignnone size-full wp-image-168" srcset="http://trlewis.net/wp-content/uploads/2014/12/miny_maxy.png 357w, http://trlewis.net/wp-content/uploads/2014/12/miny_maxy-185x300.png 185w" sizes="(max-width: 357px) 100vw, 357px" width="357" height="580"></a></p>
<p>This picture illustrates what the code is doing. It takes the higher Y
 value of both top-cells and the lower value of the bottom cells of the 
rooms gives us a vertical range that is guaranteed to contain both 
rooms.</p>
<p>Also notice that in scenario A and B there are multiple choices for 
which Y axis value to choose when connecting the dead-end to the 
adjacent room. That’s where the <code>dy</code> and <code>shift</code> values come into play. The difference in height, <code>dy</code>, is found by taking the absolute value of the difference of the min and max Y values, in math terms: <img src="Generating%20a%20Dungeon%20(part%203)%20|%20bytes%20and%20stuff_tiedostot/latex.png" alt="\Delta y = | y_{max} - y_{min} | " title="\Delta y = | y_{max} - y_{min} | " class="latex">.</p>
<p>If the <code>dy</code> is 0, (ie: both rooms are one cell tall and match on their top/bottom cells), then the shift needs to be 0. If <code>dy</code> is greater than 0, then a value between 0 and <code>dy</code>, inclusive, must be chosen. Modulus operations in the form of <code>x mod y</code> have a range between 0 and y-1 inclusive, in math terms: <img src="Generating%20a%20Dungeon%20(part%203)%20|%20bytes%20and%20stuff_tiedostot/latex_002.png" alt="[0,y)" title="[0,y)" class="latex">. So we can still get what we want in both cases by adding 1 to <code>dy</code>. </p>
<p>All of this is happens on the X axis as well if needed, hence the two if statements.</p>
<p>After the entrance is chosen the cell locations just need to be 
stored in the adjacent room, the number of connections added needs to be
 incremented, then go back to the top of the while loop:</p>
<div><div id="highlighter_385180" class="syntaxhighlighter  cpp"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp keyword bold">switch</code> <code class="cpp plain">(directionOfOther)</code></div><div class="line number2 index1 alt1"><code class="cpp plain">{</code></div><div class="line number3 index2 alt2"><code class="cpp keyword bold">case</code> <code class="cpp plain">Room::LEFT:</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">aj-&gt;startingCell2 = Vector2i(aj-&gt;bottomRight.x, miny + shift);</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">aj-&gt;previousCell2 = Vector2i(de-&gt;topLeft.x, miny + shift);</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number7 index6 alt2"><code class="cpp keyword bold">case</code> <code class="cpp plain">Room::RIGHT:</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">aj-&gt;startingCell2 = Vector2i(aj-&gt;topLeft.x, miny + shift);</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">aj-&gt;previousCell2 = Vector2i(de-&gt;bottomRight.x, miny + shift);</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number11 index10 alt2"><code class="cpp keyword bold">case</code> <code class="cpp plain">Room::UP:</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">aj-&gt;startingCell2 = Vector2i(minx + shift, aj-&gt;bottomRight.y);</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">aj-&gt;previousCell2 = Vector2i(minx + shift, de-&gt;topLeft.y);</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number15 index14 alt2"><code class="cpp keyword bold">case</code> <code class="cpp plain">Room::DOWN:</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">aj-&gt;startingCell2 = Vector2i(minx + shift, aj-&gt;topLeft.y);</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">aj-&gt;previousCell2 = Vector2i(minx + shift, de-&gt;bottomRight.y);</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number19 index18 alt2"><code class="cpp plain">}</code></div><div class="line number20 index19 alt1">&nbsp;</div><div class="line number21 index20 alt2"><code class="cpp plain">addedCount++;</code></div></div></td></tr></tbody></table></div></div>
<p>That’s all there is to it to add cycles to the dungeon. I’ve taken a 
few screenshots of a couple dungeons with and without the added cycles 
(shown in green):</p>
<p><a href="http://trlewis.net/wp-content/uploads/2014/12/linuxworking2-nocycle.png"><img src="Generating%20a%20Dungeon%20(part%203)%20|%20bytes%20and%20stuff_tiedostot/linuxworking2-nocycle.png" alt="linuxworking2-nocycle" class="alignnone size-full wp-image-179" srcset="http://trlewis.net/wp-content/uploads/2014/12/linuxworking2-nocycle.png 802w, http://trlewis.net/wp-content/uploads/2014/12/linuxworking2-nocycle-300x234.png 300w" sizes="(max-width: 802px) 100vw, 802px" width="802" height="625"></a></p>
<p><a href="http://trlewis.net/wp-content/uploads/2014/12/linuxworking2.png"><img src="Generating%20a%20Dungeon%20(part%203)%20|%20bytes%20and%20stuff_tiedostot/linuxworking2.png" alt="linuxworking2" class="alignnone size-full wp-image-178" srcset="http://trlewis.net/wp-content/uploads/2014/12/linuxworking2.png 802w, http://trlewis.net/wp-content/uploads/2014/12/linuxworking2-300x234.png 300w" sizes="(max-width: 802px) 100vw, 802px" width="802" height="625"></a></p>
<p><a href="http://trlewis.net/wp-content/uploads/2014/12/windows_nocycle.png"><img src="Generating%20a%20Dungeon%20(part%203)%20|%20bytes%20and%20stuff_tiedostot/windows_nocycle.png" alt="windows_nocycle" class="alignnone size-full wp-image-181" srcset="http://trlewis.net/wp-content/uploads/2014/12/windows_nocycle.png 816w, http://trlewis.net/wp-content/uploads/2014/12/windows_nocycle-300x235.png 300w" sizes="(max-width: 816px) 100vw, 816px" width="816" height="639"></a></p>
<p><a href="http://trlewis.net/wp-content/uploads/2014/12/windows_cycle.png"><img src="Generating%20a%20Dungeon%20(part%203)%20|%20bytes%20and%20stuff_tiedostot/windows_cycle.png" alt="windows_cycle" class="alignnone size-full wp-image-180" srcset="http://trlewis.net/wp-content/uploads/2014/12/windows_cycle.png 816w, http://trlewis.net/wp-content/uploads/2014/12/windows_cycle-300x235.png 300w" sizes="(max-width: 816px) 100vw, 816px" width="816" height="639"></a></p>
<p>I’ve uploaded a <a href="http://trlewis.net/stuff/DungeonCycles.zip">ZIP archive</a> containing the source code for this project. Since part 2 I’ve switched from <a href="http://libsdl.org/">SDL</a> to <a href="http://www.sfml-dev.org/">SFML</a> for drawing.</p>
	</div><!-- .entry-content -->
	
	<footer class="entry-meta"><span class="tag-links"><a href="http://trlewis.net/tag/cpp/" rel="tag">C++</a><a href="http://trlewis.net/tag/sfml/" rel="tag">SFML</a></span></footer></article><!-- #post-## -->
	<nav class="navigation post-navigation" role="navigation">
		<h1 class="screen-reader-text">Post navigation</h1>
		<div class="nav-links">
			<a href="http://trlewis.net/generation-a-dungeon-part-2/" rel="prev"><span class="meta-nav">Previous Post</span>Generating a Dungeon (part 2)</a><a href="http://trlewis.net/working-with-a-7-segment-display/" rel="next"><span class="meta-nav">Next Post</span>Working with a 7-segment display</a>		</div><!-- .nav-links -->
	</nav><!-- .navigation -->
	
<div id="comments" class="comments-area">

	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://trlewis.net/generating-a-dungeon-part-3/#respond" style="display:none;">Cancel reply</a></small></h3>			<form action="http://trlewis.net/wp-comments-post.php" method="post" id="commentform" class="comment-form anti-spam-form-processed" novalidate="">
				<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" size="30" maxlength="245" aria-required="true" required="required" type="text"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" size="30" maxlength="100" aria-describedby="email-notes" aria-required="true" required="required" type="email"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" size="30" maxlength="200" type="url"></p>
<p class="form-submit"><input name="submit" id="submit" class="submit" value="Post Comment" type="submit"> <input name="comment_post_ID" value="151" id="comment_post_ID" type="hidden">
<input name="comment_parent" id="comment_parent" value="0" type="hidden">
</p>		<p class="antispam-group antispam-group-q" style="clear: both; display: none;">
			<label>Current ye@r <span class="required">*</span></label>
			<input name="antspm-a" class="antispam-control antispam-control-a" value="2018" type="hidden">
			<input name="antspm-q" class="antispam-control antispam-control-q" value="2018" autocomplete="off" type="text">
		</p>
		<p class="antispam-group antispam-group-e" style="display: none;">
			<label>Leave this field empty</label>
			<input name="antspm-e-email-url-website" class="antispam-control antispam-control-e" autocomplete="off" type="text">
		</p>
			<input name="antspm-d" class="antispam-control antispam-control-d" value="2018" type="hidden"></form>
			</div><!-- #respond -->
	
</div><!-- #comments -->
		</div><!-- #content -->
	</div><!-- #primary -->

<div id="secondary">
		<h2 class="site-description">Doing all things</h2>
	
	
		<div id="primary-sidebar" class="primary-sidebar widget-area" role="complementary">
		<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="http://trlewis.net/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input class="search-field" placeholder="Search …" name="s" type="search">
				</label>
				<input class="search-submit" value="Search" type="submit">
			</form></aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h1 class="widget-title">Recent Posts</h1>		<ul>
					<li>
				<a href="http://trlewis.net/bitmap-pixel-fonts/">Bitmap (Pixel) Fonts</a>
						</li>
					<li>
				<a href="http://trlewis.net/2-look-oll-flashcards/">2-Look OLL Flashcards</a>
						</li>
					<li>
				<a href="http://trlewis.net/detecting-line-crossings/">Detecting Line Crossings</a>
						</li>
					<li>
				<a href="http://trlewis.net/hosting-an-sfml-renderwindow-inside-a-wpf-application/">SFML.Net and WPF</a>
						</li>
					<li>
				<a href="http://trlewis.net/following-directions-repeatedly/">Following Directions (repeatedly)</a>
						</li>
				</ul>
		</aside>		<aside id="recent-comments-2" class="widget widget_recent_comments"><h1 class="widget-title">Recent Comments</h1><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link">Josh</span> on <a href="http://trlewis.net/working-with-a-7-segment-display/#comment-8">Working with a 7-segment display</a></li></ul></aside><aside id="archives-2" class="widget widget_archive"><h1 class="widget-title">Archives</h1>		<ul>
			<li><a href="http://trlewis.net/2017/04/">April 2017</a></li>
	<li><a href="http://trlewis.net/2017/02/">February 2017</a></li>
	<li><a href="http://trlewis.net/2016/11/">November 2016</a></li>
	<li><a href="http://trlewis.net/2016/04/">April 2016</a></li>
	<li><a href="http://trlewis.net/2016/03/">March 2016</a></li>
	<li><a href="http://trlewis.net/2015/09/">September 2015</a></li>
	<li><a href="http://trlewis.net/2015/08/">August 2015</a></li>
	<li><a href="http://trlewis.net/2015/06/">June 2015</a></li>
	<li><a href="http://trlewis.net/2015/04/">April 2015</a></li>
	<li><a href="http://trlewis.net/2015/02/">February 2015</a></li>
	<li><a href="http://trlewis.net/2014/12/">December 2014</a></li>
	<li><a href="http://trlewis.net/2014/11/">November 2014</a></li>
		</ul>
		</aside><aside id="categories-2" class="widget widget_categories"><h1 class="widget-title">Categories</h1>		<ul>
	<li class="cat-item cat-item-11"><a href="http://trlewis.net/category/arduino/">Arduino</a>
</li>
	<li class="cat-item cat-item-7"><a href="http://trlewis.net/category/game-dev/">Game Dev</a>
</li>
	<li class="cat-item cat-item-3"><a href="http://trlewis.net/category/math/">Math</a>
</li>
	<li class="cat-item cat-item-2"><a href="http://trlewis.net/category/programming/">Programming</a>
</li>
	<li class="cat-item cat-item-1"><a href="http://trlewis.net/category/uncategorized/">Uncategorized</a>
</li>
		</ul>
</aside><aside id="tag_cloud-3" class="widget widget_tag_cloud"><h1 class="widget-title">Tags</h1><div class="tagcloud"><a href="http://trlewis.net/tag/algorithms/" class="tag-link-20 tag-link-position-1" title="2 topics" style="font-size: 13.25pt;">Algorithms</a>
<a href="http://trlewis.net/tag/android/" class="tag-link-19 tag-link-position-2" title="1 topic" style="font-size: 8pt;">Android</a>
<a href="http://trlewis.net/tag/bot/" class="tag-link-23 tag-link-position-3" title="1 topic" style="font-size: 8pt;">Bot</a>
<a href="http://trlewis.net/tag/csharp/" class="tag-link-4 tag-link-position-4" title="5 topics" style="font-size: 22pt;">C#</a>
<a href="http://trlewis.net/tag/cpp/" class="tag-link-6 tag-link-position-5" title="5 topics" style="font-size: 22pt;">C++</a>
<a href="http://trlewis.net/tag/cellular-automata/" class="tag-link-16 tag-link-position-6" title="1 topic" style="font-size: 8pt;">Cellular Automata</a>
<a href="http://trlewis.net/tag/html/" class="tag-link-29 tag-link-position-7" title="1 topic" style="font-size: 8pt;">HTML</a>
<a href="http://trlewis.net/tag/java/" class="tag-link-17 tag-link-position-8" title="1 topic" style="font-size: 8pt;">Java</a>
<a href="http://trlewis.net/tag/javascript/" class="tag-link-26 tag-link-position-9" title="2 topics" style="font-size: 13.25pt;">Javascript</a>
<a href="http://trlewis.net/tag/python/" class="tag-link-14 tag-link-position-10" title="4 topics" style="font-size: 19.6666666667pt;">Python</a>
<a href="http://trlewis.net/tag/regex/" class="tag-link-22 tag-link-position-11" title="1 topic" style="font-size: 8pt;">Regex</a>
<a href="http://trlewis.net/tag/sdl/" class="tag-link-8 tag-link-position-12" title="2 topics" style="font-size: 13.25pt;">SDL</a>
<a href="http://trlewis.net/tag/sfml/" class="tag-link-10 tag-link-position-13" title="4 topics" style="font-size: 19.6666666667pt;">SFML</a>
<a href="http://trlewis.net/tag/short-code/" class="tag-link-21 tag-link-position-14" title="4 topics" style="font-size: 19.6666666667pt;">Short Code</a>
<a href="http://trlewis.net/tag/sockets/" class="tag-link-13 tag-link-position-15" title="1 topic" style="font-size: 8pt;">Sockets</a>
<a href="http://trlewis.net/tag/threading/" class="tag-link-12 tag-link-position-16" title="1 topic" style="font-size: 8pt;">Threading</a>
<a href="http://trlewis.net/tag/vector-math/" class="tag-link-28 tag-link-position-17" title="1 topic" style="font-size: 8pt;">Vector Math</a>
<a href="http://trlewis.net/tag/xaml/" class="tag-link-27 tag-link-position-18" title="1 topic" style="font-size: 8pt;">XAML</a>
<a href="http://trlewis.net/tag/xml/" class="tag-link-18 tag-link-position-19" title="1 topic" style="font-size: 8pt;">XML</a></div>
</aside>	</div><!-- #primary-sidebar -->
	</div><!-- #secondary -->

		</div><!-- #main -->

		<footer id="colophon" class="site-footer" role="contentinfo">

			
			<div class="site-info">
								<a href="https://wordpress.org/">Proudly powered by WordPress</a>
			</div><!-- .site-info -->
		</footer><!-- #colophon -->
	</div><!-- #page -->

	







</body></html>