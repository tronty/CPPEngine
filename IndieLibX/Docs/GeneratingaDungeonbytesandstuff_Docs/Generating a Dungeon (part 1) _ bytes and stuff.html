<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) & !(IE 8)]><!-->
<html lang="en-US"><!--<![endif]--><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<title>Generating a Dungeon (part 1) | bytes and stuff</title>
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="pingback" href="http://trlewis.net/xmlrpc.php">
	<!--[if lt IE 9]>
	
	<![endif]-->
	<link rel="dns-prefetch" href="http://fonts.googleapis.com/">
<link rel="dns-prefetch" href="http://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="bytes and stuff » Feed" href="http://trlewis.net/feed/">
<link rel="alternate" type="application/rss+xml" title="bytes and stuff » Comments Feed" href="http://trlewis.net/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="bytes and stuff » Generating a Dungeon (part 1) Comments Feed" href="http://trlewis.net/generating-a-dungeon-part-1/feed/">
		
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="twentyfourteen-lato-css" href="Generating%20a%20Dungeon%20(part%201)%20|%20bytes%20and%20stuff_tiedostot/css.css" type="text/css" media="all">
<link rel="stylesheet" id="genericons-css" href="Generating%20a%20Dungeon%20(part%201)%20|%20bytes%20and%20stuff_tiedostot/genericons.css" type="text/css" media="all">
<link rel="stylesheet" id="twentyfourteen-style-css" href="Generating%20a%20Dungeon%20(part%201)%20|%20bytes%20and%20stuff_tiedostot/style.css" type="text/css" media="all">
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentyfourteen-ie-css'  href='http://trlewis.net/wp-content/themes/twentyfourteen/css/ie.css?ver=20131205' type='text/css' media='all' />
<![endif]-->


<link rel="https://api.w.org/" href="http://trlewis.net/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://trlewis.net/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://trlewis.net/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Factorial Zeroes 2" href="http://trlewis.net/factorial-zeroes-2/">
<link rel="next" title="Generating a Dungeon (part 2)" href="http://trlewis.net/generation-a-dungeon-part-2/">
<meta name="generator" content="WordPress 4.7.10">
<link rel="canonical" href="http://trlewis.net/generating-a-dungeon-part-1/">
<link rel="shortlink" href="http://trlewis.net/?p=79">
<link rel="alternate" type="application/json+oembed" href="http://trlewis.net/wp-json/oembed/1.0/embed?url=http%3A%2F%2Ftrlewis.net%2Fgenerating-a-dungeon-part-1%2F">
<link rel="alternate" type="text/xml+oembed" href="http://trlewis.net/wp-json/oembed/1.0/embed?url=http%3A%2F%2Ftrlewis.net%2Fgenerating-a-dungeon-part-1%2F&amp;format=xml">
		<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
		<style type="text/css">
/* <![CDATA[ */
img.latex { vertical-align: middle; border: none; }
/* ]]> */
</style>
<style type="text/css" id="custom-background-css">
body.custom-background { background-image: url("http://trlewis.net/wp-content/uploads/2014/11/bgpattern.png"); background-position: left top; background-size: auto; background-repeat: repeat; background-attachment: scroll; }
</style>
<link rel="stylesheet" type="text/css" href="Generating%20a%20Dungeon%20(part%201)%20|%20bytes%20and%20stuff_tiedostot/shCore.css"><link rel="stylesheet" type="text/css" href="Generating%20a%20Dungeon%20(part%201)%20|%20bytes%20and%20stuff_tiedostot/shThemeDefault.css"><style type="text/css" id="syntaxhighlighteranchor"></style>
</head>

<body class="post-template-default single single-post postid-79 single-format-standard custom-background masthead-fixed full-width singular">
<div id="page" class="hfeed site">
	
	<header id="masthead" class="site-header" role="banner">
		<div class="header-main">
			<h1 class="site-title"><a href="http://trlewis.net/" rel="home">bytes and stuff</a></h1>

			<div class="search-toggle">
				<a href="#search-container" class="screen-reader-text" aria-expanded="false" aria-controls="search-container">Search</a>
			</div>

			<nav id="primary-navigation" class="site-navigation primary-navigation" role="navigation">
				<button class="menu-toggle">Primary Menu</button>
				<a class="screen-reader-text skip-link" href="#content">Skip to content</a>
				<div class="menu-headermenu-container"><ul id="primary-menu" class="nav-menu"><li id="menu-item-109" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-109"><a href="http://trlewis.net/about/">Contact</a></li>
</ul></div>			</nav>
		</div>

		<div id="search-container" class="search-box-wrapper hide">
			<div class="search-box">
				<form role="search" method="get" class="search-form" action="http://trlewis.net/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input class="search-field" placeholder="Search …" name="s" type="search">
				</label>
				<input class="search-submit" value="Search" type="submit">
			</form>			</div>
		</div>
	</header><!-- #masthead -->

	<div id="main" class="site-main">

	<div id="primary" class="content-area">
		<div id="content" class="site-content" role="main">
			
<article id="post-79" class="post-79 post type-post status-publish format-standard hentry category-game-dev category-programming tag-cpp tag-sdl">
	
	<header class="entry-header">
				<div class="entry-meta">
			<span class="cat-links"><a href="http://trlewis.net/category/game-dev/" rel="category tag">Game Dev</a>, <a href="http://trlewis.net/category/programming/" rel="category tag">Programming</a></span>
		</div>
		<h1 class="entry-title">Generating a Dungeon (part 1)</h1>
		<div class="entry-meta">
			<span class="entry-date"><a href="http://trlewis.net/generating-a-dungeon-part-1/" rel="bookmark"><time class="entry-date" datetime="2014-11-18T20:13:57+00:00">November 18, 2014</time></a></span> <span class="byline"><span class="author vcard"><a class="url fn n" href="http://trlewis.net/author/econobeing/" rel="author">Travis</a></span></span>			<span class="comments-link"><a href="http://trlewis.net/generating-a-dungeon-part-1/#respond">Leave a comment</a></span>
					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>I’ve been wanting to create a game that uses randomly generated 
dungeons for a while now but didn’t have a good idea about what kind of 
game to make. Recently though I decided “so what if I don’t have an idea
 for what to DO with the dungeons, I can figure that out after I make 
them.” So I set out to make some code that will generate random 
dungeons.</p>
<p><span id="more-79"></span></p>
<p>I did some research before I started to see what methods other people have used and what kinds of dungeons they’ve yielded.</p>
<h4>Binary Space Partition (BSP)</h4>
<p><img src="Generating%20a%20Dungeon%20(part%201)%20|%20bytes%20and%20stuff_tiedostot/dungeon_bsp7.png"></p>
<p><a href="http://eskerda.com/bsp-dungeon-generation/">Here</a> and <a href="http://www.roguebasin.com/index.php?title=Basic_BSP_Dungeon_generation">here</a> are a couple of pages with pictures and code.</p>
<p>This is the first method I looked at and it involves recursively 
dividing a rectangle into sub-rectangles, taking portions of those and 
turning them into rooms. It’s definitely a good way to generate a map, 
but I didn’t quite like the look of the result. I didn’t really want 
long corridors in my dungeons, and I wanted them to have a more 
grid-like feel, similar to a 2D Zelda game.</p>
<h4>Cellular Automata</h4>
<p><img src="Generating%20a%20Dungeon%20(part%201)%20|%20bytes%20and%20stuff_tiedostot/gdt-sim2.png"></p>
<p><a href="http://gamedevelopment.tutsplus.com/tutorials/generate-random-cave-levels-using-cellular-automata--gamedev-9664">This page</a> has a good explanation and interactive demo on generating maps using cellular automata.</p>
<p>This method was pretty interesting in that it’s pretty simple and the
 maps are very un-grid-like in appearance. Which unfortunately isn’t 
what I was looking for. The maps it generates look more like cave 
systems than man-made dungeons. However, if I want to add a second 
dungeon “type” at some point I’ll definitely give the cellular automata 
method some consideration.</p>
<p>After a bit more searching I failed to find anything that looked like
 what I was imagining my dungeons would look like, so I decided to take a
 stab at creating it myself.</p>
<h4>Defining the style</h4>
<p>Before I could start writing code to create the dungeons first I would have to figure out exactly what went into making them.</p>
<ol>
<li>The dungeon size is defined in two dimensions with numbers, for example “20×15”. I ended up calling these “cells”.</li>
<li>There needs to be some empty cells in the dungeon.</li>
<li>Rooms are rectangular and can occupy multiple cells. I chose room 
size ranges from 1-3 cells in both directions. This was an arbitrary 
choice and could easily be changed in the future</li>
<li>The start and ending rooms in the dungeon need to be some minimum distance from each-other.</li>
<li>The pathways between rooms should be short, no long corridors are desired</li>
<li>The dungeon needs to <em>not</em> be a tree. i.e.: There should be 
some cycles in the dungeon. This should help reduce backtracking so the 
user spends more time in rooms that they haven’t been in yet.</li>
</ol>
<p>Here’s a quick image I drew up as an example of what I was looking for:</p>
<p><a href="http://trlewis.net/wp-content/uploads/2014/11/paintdungeon2.png"><img src="Generating%20a%20Dungeon%20(part%201)%20|%20bytes%20and%20stuff_tiedostot/paintdungeon2.png" alt="paintdungeon" class="alignnone size-full wp-image-91" srcset="http://trlewis.net/wp-content/uploads/2014/11/paintdungeon2.png 355w, http://trlewis.net/wp-content/uploads/2014/11/paintdungeon2-300x190.png 300w" sizes="(max-width: 355px) 100vw, 355px" width="355" height="225"></a></p>
<p>Item 1 was quite easy. I chose to store the grid of cells as a 2D-array of chars. I used a vector of vectors instead of a <code>char[][]</code>
 because I was having trouble declaring it in the header file without 
defining the size. They can still be accessed like an array anyway. In 
the grid periods are used as unassigned cells.</p>
<div><div id="highlighter_934371" class="syntaxhighlighter  cpp"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">myMapCells = std::vector&lt;std::vector&lt;</code><code class="cpp color1 bold">char</code><code class="cpp plain">&gt;&gt;();</code></div><div class="line number2 index1 alt1"><code class="cpp keyword bold">for</code> <code class="cpp plain">(</code><code class="cpp color1 bold">int</code> <code class="cpp plain">y = 0; y &lt; myHeight; y++)</code></div><div class="line number3 index2 alt2"><code class="cpp plain">{</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">std::vector&lt;</code><code class="cpp color1 bold">char</code><code class="cpp plain">&gt; row = std::vector&lt;</code><code class="cpp color1 bold">char</code><code class="cpp plain">&gt;();</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code> <code class="cpp plain">(</code><code class="cpp color1 bold">int</code> <code class="cpp plain">x = 0; x &lt; myWidth; x++)</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">row.push_back(</code><code class="cpp string">'.'</code><code class="cpp plain">);</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">myMapCells.push_back(row);</code></div><div class="line number9 index8 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>The next thing I added in was item 2, empty cells. The plan was to 
pick a random sized “empty room” between 1×1 and 3×3 cells in size, pick
 a random location for it in the map, and place it if it fits. Cells 
designated as being empty are denoted with an ‘X’. </p>
<div><div id="highlighter_100351" class="syntaxhighlighter  cpp"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp keyword bold">void</code> <code class="cpp plain">GeneratedMap::createEmptyCells()</code></div><div class="line number2 index1 alt1"><code class="cpp plain">{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">std::vector&lt;Room&gt; emptyRooms;</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">numEmpties = (myWidth * myHeight) * 0.20; </code><code class="cpp comments">//20% of cells are empty</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code> <code class="cpp plain">(</code><code class="cpp keyword bold">true</code><code class="cpp plain">)</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//empty vector of rooms</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">emptyRooms.clear();</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">emptyCellCount = 0;</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code> <code class="cpp plain">(emptyCellCount &lt; numEmpties)</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//randomly pick a size</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">width = 0;</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">num = </code><code class="cpp functions bold">rand</code><code class="cpp plain">() % 100;</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(num &lt; 40)</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">width = 0;</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">else</code> <code class="cpp keyword bold">if</code> <code class="cpp plain">(num &gt;= 40 &amp;&amp; num &lt; 80)</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">width = 1;</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">else</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">width = 2;</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">height = 0;</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">num = </code><code class="cpp functions bold">rand</code><code class="cpp plain">() % 100;</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(num &lt; 40)</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">height = 0;</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">else</code> <code class="cpp keyword bold">if</code> <code class="cpp plain">(num &gt;= 40 &amp;&amp; num &lt; 80)</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">height = 1;</code></div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">else</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">height = 2;</code></div><div class="line number30 index29 alt1">&nbsp;</div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//randomly pick location</code></div><div class="line number32 index31 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">xpos = </code><code class="cpp functions bold">rand</code><code class="cpp plain">() % (myWidth - (width)); </code></div><div class="line number33 index32 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">ypos = </code><code class="cpp functions bold">rand</code><code class="cpp plain">() % (myHeight - (height));</code></div><div class="line number34 index33 alt1">&nbsp;</div><div class="line number35 index34 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//randomly pick a size</code></div><div class="line number36 index35 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Vector2i topLeft(xpos, ypos);</code></div><div class="line number37 index36 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Vector2i bottomRight(xpos + width , ypos + height);</code></div><div class="line number38 index37 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number39 index38 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(canPlaceRoom(topLeft, bottomRight))</code></div><div class="line number40 index39 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number41 index40 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//if it fits then add it to the list</code></div><div class="line number42 index41 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Room emptyRoom(topLeft, bottomRight);</code></div><div class="line number43 index42 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">emptyRooms.push_back(emptyRoom);</code></div><div class="line number44 index43 alt1">&nbsp;</div><div class="line number45 index44 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//fill cells in map</code></div><div class="line number46 index45 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">replacePeriods(topLeft, bottomRight, </code><code class="cpp string">'X'</code><code class="cpp plain">);</code></div><div class="line number47 index46 alt2">&nbsp;</div><div class="line number48 index47 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//recalculate number of empty cells</code></div><div class="line number49 index48 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">emptyCellCount = 0;</code></div><div class="line number50 index49 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code> <code class="cpp plain">(</code><code class="cpp color1 bold">int</code> <code class="cpp plain">i = 0; i &lt; emptyRooms.size(); i++)</code></div><div class="line number51 index50 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">emptyCellCount += emptyRooms[i].getArea();</code></div><div class="line number52 index51 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number53 index52 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number54 index53 alt1">&nbsp;</div><div class="line number55 index54 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(allUnassignedReachable())</code></div><div class="line number56 index55 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number57 index56 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">else</code></div><div class="line number58 index57 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">removeEmpties();</code></div><div class="line number59 index58 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number60 index59 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Then once the desired number of empty cells have been reserved, test 
to see that all of the other unassigned cells are still reachable by 
picking one of them then flood filling the map from that location. If 
the empty cells have been placed correctly the map should now consist of
 empty cells (‘X’) and test (‘T’) cells, no unassigned (‘.’) cells 
should remain. If there are unassigned cells left, that means that the 
empty cell placement has partitioned the dungeon into two separate 
parts. This is bad because it could result in orphaned rooms, large 
chunks of the dungeon not being generated, or the end room being 
unreachable. In such a case the cells all get reset to unassigned and it
 tries to randomly place empty cells again.</p>
<p>The code that floods the map to check if all unassigned cells are 
reachable is below. It works by randomly picking cells until it finds an
 unassigned one (it could have just checked in a linear fashion for the 
first empty cell and went from there but I had been generating a lot of 
random numbers before then so I guess I was just in the frame of mind). 
It then adds that cell’s location to a queue. While there are locations 
in the queue the program will dequeue the first item, mark any 
unassigned neighbors in the up/down/left/right directions with a ‘T’, 
and enqueue all of the locations it marked. It then dequeues the next 
item and repeats the process until there are no locations left in the 
queue.</p>
<p>When the flooding is done it checks the map by removing all the ‘T’ 
characters, if it runs into a ‘.’ unassigned cell while doing that then 
the map is bad and generation must start over.</p>
<div><div id="highlighter_136036" class="syntaxhighlighter  cpp"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">bool</code> <code class="cpp plain">GeneratedMap::allUnassignedReachable()</code></div><div class="line number2 index1 alt1"><code class="cpp plain">{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">std::queue&lt;Vector2i&gt; queue;</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Vector2i start(0, 0);</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code> <code class="cpp plain">(myMapCells[start.y][start.x] != </code><code class="cpp string">'.'</code><code class="cpp plain">)</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">start.x = </code><code class="cpp functions bold">rand</code><code class="cpp plain">() % myWidth;</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">start.y = </code><code class="cpp functions bold">rand</code><code class="cpp plain">() % myHeight;</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">queue.push(start);</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code> <code class="cpp plain">(queue.size() &gt; 0)</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Vector2i cell = queue.front();</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">queue.pop();</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//left</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(cell.x &gt; 0 &amp;&amp; myMapCells[cell.y][cell.x - 1] == </code><code class="cpp string">'.'</code><code class="cpp plain">)</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Vector2i newCell(cell.x - 1, cell.y);</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">myMapCells[newCell.y][newCell.x] = </code><code class="cpp string">'T'</code><code class="cpp plain">;</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">queue.push(newCell);</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number24 index23 alt1">&nbsp;</div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//right</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(cell.x &lt; myWidth - 1 &amp;&amp; myMapCells[cell.y][cell.x + 1] == </code><code class="cpp string">'.'</code><code class="cpp plain">)</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Vector2i newCell(cell.x + 1, cell.y);</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">myMapCells[newCell.y][newCell.x] = </code><code class="cpp string">'T'</code><code class="cpp plain">;</code></div><div class="line number30 index29 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">queue.push(newCell);</code></div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number32 index31 alt1">&nbsp;</div><div class="line number33 index32 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//top</code></div><div class="line number34 index33 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(cell.y &gt; 0 &amp;&amp; myMapCells[cell.y - 1][cell.x] == </code><code class="cpp string">'.'</code><code class="cpp plain">)</code></div><div class="line number35 index34 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number36 index35 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Vector2i newCell(cell.x, cell.y - 1);</code></div><div class="line number37 index36 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">myMapCells[newCell.y][newCell.x] = </code><code class="cpp string">'T'</code><code class="cpp plain">;</code></div><div class="line number38 index37 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">queue.push(newCell);</code></div><div class="line number39 index38 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number40 index39 alt1">&nbsp;</div><div class="line number41 index40 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//bottom</code></div><div class="line number42 index41 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(cell.y &lt; myHeight - 1 &amp;&amp; myMapCells[cell.y + 1][cell.x] == </code><code class="cpp string">'.'</code><code class="cpp plain">)</code></div><div class="line number43 index42 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number44 index43 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Vector2i newCell(cell.x, cell.y + 1);</code></div><div class="line number45 index44 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">myMapCells[newCell.y][newCell.x] = </code><code class="cpp string">'T'</code><code class="cpp plain">;</code></div><div class="line number46 index45 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">queue.push(newCell);</code></div><div class="line number47 index46 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number48 index47 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number49 index48 alt2">&nbsp;</div><div class="line number50 index49 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//make sure no unassigned cells remain</code></div><div class="line number51 index50 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">bool</code> <code class="cpp plain">result = </code><code class="cpp keyword bold">true</code><code class="cpp plain">;</code></div><div class="line number52 index51 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code> <code class="cpp plain">(</code><code class="cpp color1 bold">int</code> <code class="cpp plain">y = 0; y &lt; myHeight; y++)</code></div><div class="line number53 index52 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number54 index53 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code> <code class="cpp plain">(</code><code class="cpp color1 bold">int</code> <code class="cpp plain">x = 0; x &lt; myWidth; x++)</code></div><div class="line number55 index54 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number56 index55 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code> <code class="cpp plain">(myMapCells[y][x] == </code><code class="cpp string">'.'</code><code class="cpp plain">)</code></div><div class="line number57 index56 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">result = </code><code class="cpp keyword bold">false</code><code class="cpp plain">;</code></div><div class="line number58 index57 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">else</code> <code class="cpp keyword bold">if</code> <code class="cpp plain">(myMapCells[y][x] == </code><code class="cpp string">'T'</code><code class="cpp plain">)</code></div><div class="line number59 index58 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">myMapCells[y][x] = </code><code class="cpp string">'.'</code><code class="cpp plain">;</code></div><div class="line number60 index59 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number61 index60 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number62 index61 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">result;</code></div><div class="line number63 index62 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Once that’s done and returns true we have a map that contains 
unassigned cells and reserved empty cells. Which admittedly isn’t much 
to look at, but it’s definitely progress towards a dungeon. I added in 
some code to print out the unassigned/empty cell map to the console once
 the empty cells are successfully placed, here’s an example output:</p>
<p><a href="http://trlewis.net/wp-content/uploads/2014/11/withempties.png"><img src="Generating%20a%20Dungeon%20(part%201)%20|%20bytes%20and%20stuff_tiedostot/withempties.png" alt="withempties" class="alignnone size-full wp-image-112" srcset="http://trlewis.net/wp-content/uploads/2014/11/withempties.png 413w, http://trlewis.net/wp-content/uploads/2014/11/withempties-251x300.png 251w" sizes="(max-width: 413px) 100vw, 413px" width="413" height="492"></a></p>
<p>After that the next step is “flooding” the map with rooms. I’ll write
 that bit up in another post. This one is starting to get a little 
lengthy. I’ve put all the source files containing the progress I’ve made
 into a .zip file that you can <a href="http://trlewis.net/stuff/DungeonGeneration01.zip">download here</a>. I also have a <a href="https://github.com/trlewis/DungeonGame">GitHub repo</a> for the work in progress, which may or may not be significantly different from the point in time I am writing this post.</p>
<p>The code requires <a href="http://libsdl.org/">SDL2</a> to work. Shoutout to Lazy Foo for creating <a href="http://lazyfoo.net/tutorials/SDL/01_hello_SDL/index.php"> this extremely helpful tutorial</a> on getting an SDL2 project compiled and running.</p>
	</div><!-- .entry-content -->
	
	<footer class="entry-meta"><span class="tag-links"><a href="http://trlewis.net/tag/cpp/" rel="tag">C++</a><a href="http://trlewis.net/tag/sdl/" rel="tag">SDL</a></span></footer></article><!-- #post-## -->
	<nav class="navigation post-navigation" role="navigation">
		<h1 class="screen-reader-text">Post navigation</h1>
		<div class="nav-links">
			<a href="http://trlewis.net/factorial-zeroes-2/" rel="prev"><span class="meta-nav">Previous Post</span>Factorial Zeroes 2</a><a href="http://trlewis.net/generation-a-dungeon-part-2/" rel="next"><span class="meta-nav">Next Post</span>Generating a Dungeon (part 2)</a>		</div><!-- .nav-links -->
	</nav><!-- .navigation -->
	
<div id="comments" class="comments-area">

	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://trlewis.net/generating-a-dungeon-part-1/#respond" style="display:none;">Cancel reply</a></small></h3>			<form action="http://trlewis.net/wp-comments-post.php" method="post" id="commentform" class="comment-form anti-spam-form-processed" novalidate="">
				<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" size="30" maxlength="245" aria-required="true" required="required" type="text"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" size="30" maxlength="100" aria-describedby="email-notes" aria-required="true" required="required" type="email"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" size="30" maxlength="200" type="url"></p>
<p class="form-submit"><input name="submit" id="submit" class="submit" value="Post Comment" type="submit"> <input name="comment_post_ID" value="79" id="comment_post_ID" type="hidden">
<input name="comment_parent" id="comment_parent" value="0" type="hidden">
</p>		<p class="antispam-group antispam-group-q" style="clear: both; display: none;">
			<label>Current ye@r <span class="required">*</span></label>
			<input name="antspm-a" class="antispam-control antispam-control-a" value="2018" type="hidden">
			<input name="antspm-q" class="antispam-control antispam-control-q" value="2018" autocomplete="off" type="text">
		</p>
		<p class="antispam-group antispam-group-e" style="display: none;">
			<label>Leave this field empty</label>
			<input name="antspm-e-email-url-website" class="antispam-control antispam-control-e" autocomplete="off" type="text">
		</p>
			<input name="antspm-d" class="antispam-control antispam-control-d" value="2018" type="hidden"></form>
			</div><!-- #respond -->
	
</div><!-- #comments -->
		</div><!-- #content -->
	</div><!-- #primary -->

<div id="secondary">
		<h2 class="site-description">Doing all things</h2>
	
	
		<div id="primary-sidebar" class="primary-sidebar widget-area" role="complementary">
		<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="http://trlewis.net/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input class="search-field" placeholder="Search …" name="s" type="search">
				</label>
				<input class="search-submit" value="Search" type="submit">
			</form></aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h1 class="widget-title">Recent Posts</h1>		<ul>
					<li>
				<a href="http://trlewis.net/bitmap-pixel-fonts/">Bitmap (Pixel) Fonts</a>
						</li>
					<li>
				<a href="http://trlewis.net/2-look-oll-flashcards/">2-Look OLL Flashcards</a>
						</li>
					<li>
				<a href="http://trlewis.net/detecting-line-crossings/">Detecting Line Crossings</a>
						</li>
					<li>
				<a href="http://trlewis.net/hosting-an-sfml-renderwindow-inside-a-wpf-application/">SFML.Net and WPF</a>
						</li>
					<li>
				<a href="http://trlewis.net/following-directions-repeatedly/">Following Directions (repeatedly)</a>
						</li>
				</ul>
		</aside>		<aside id="recent-comments-2" class="widget widget_recent_comments"><h1 class="widget-title">Recent Comments</h1><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link">Josh</span> on <a href="http://trlewis.net/working-with-a-7-segment-display/#comment-8">Working with a 7-segment display</a></li></ul></aside><aside id="archives-2" class="widget widget_archive"><h1 class="widget-title">Archives</h1>		<ul>
			<li><a href="http://trlewis.net/2017/04/">April 2017</a></li>
	<li><a href="http://trlewis.net/2017/02/">February 2017</a></li>
	<li><a href="http://trlewis.net/2016/11/">November 2016</a></li>
	<li><a href="http://trlewis.net/2016/04/">April 2016</a></li>
	<li><a href="http://trlewis.net/2016/03/">March 2016</a></li>
	<li><a href="http://trlewis.net/2015/09/">September 2015</a></li>
	<li><a href="http://trlewis.net/2015/08/">August 2015</a></li>
	<li><a href="http://trlewis.net/2015/06/">June 2015</a></li>
	<li><a href="http://trlewis.net/2015/04/">April 2015</a></li>
	<li><a href="http://trlewis.net/2015/02/">February 2015</a></li>
	<li><a href="http://trlewis.net/2014/12/">December 2014</a></li>
	<li><a href="http://trlewis.net/2014/11/">November 2014</a></li>
		</ul>
		</aside><aside id="categories-2" class="widget widget_categories"><h1 class="widget-title">Categories</h1>		<ul>
	<li class="cat-item cat-item-11"><a href="http://trlewis.net/category/arduino/">Arduino</a>
</li>
	<li class="cat-item cat-item-7"><a href="http://trlewis.net/category/game-dev/">Game Dev</a>
</li>
	<li class="cat-item cat-item-3"><a href="http://trlewis.net/category/math/">Math</a>
</li>
	<li class="cat-item cat-item-2"><a href="http://trlewis.net/category/programming/">Programming</a>
</li>
	<li class="cat-item cat-item-1"><a href="http://trlewis.net/category/uncategorized/">Uncategorized</a>
</li>
		</ul>
</aside><aside id="tag_cloud-3" class="widget widget_tag_cloud"><h1 class="widget-title">Tags</h1><div class="tagcloud"><a href="http://trlewis.net/tag/algorithms/" class="tag-link-20 tag-link-position-1" title="2 topics" style="font-size: 13.25pt;">Algorithms</a>
<a href="http://trlewis.net/tag/android/" class="tag-link-19 tag-link-position-2" title="1 topic" style="font-size: 8pt;">Android</a>
<a href="http://trlewis.net/tag/bot/" class="tag-link-23 tag-link-position-3" title="1 topic" style="font-size: 8pt;">Bot</a>
<a href="http://trlewis.net/tag/csharp/" class="tag-link-4 tag-link-position-4" title="5 topics" style="font-size: 22pt;">C#</a>
<a href="http://trlewis.net/tag/cpp/" class="tag-link-6 tag-link-position-5" title="5 topics" style="font-size: 22pt;">C++</a>
<a href="http://trlewis.net/tag/cellular-automata/" class="tag-link-16 tag-link-position-6" title="1 topic" style="font-size: 8pt;">Cellular Automata</a>
<a href="http://trlewis.net/tag/html/" class="tag-link-29 tag-link-position-7" title="1 topic" style="font-size: 8pt;">HTML</a>
<a href="http://trlewis.net/tag/java/" class="tag-link-17 tag-link-position-8" title="1 topic" style="font-size: 8pt;">Java</a>
<a href="http://trlewis.net/tag/javascript/" class="tag-link-26 tag-link-position-9" title="2 topics" style="font-size: 13.25pt;">Javascript</a>
<a href="http://trlewis.net/tag/python/" class="tag-link-14 tag-link-position-10" title="4 topics" style="font-size: 19.6666666667pt;">Python</a>
<a href="http://trlewis.net/tag/regex/" class="tag-link-22 tag-link-position-11" title="1 topic" style="font-size: 8pt;">Regex</a>
<a href="http://trlewis.net/tag/sdl/" class="tag-link-8 tag-link-position-12" title="2 topics" style="font-size: 13.25pt;">SDL</a>
<a href="http://trlewis.net/tag/sfml/" class="tag-link-10 tag-link-position-13" title="4 topics" style="font-size: 19.6666666667pt;">SFML</a>
<a href="http://trlewis.net/tag/short-code/" class="tag-link-21 tag-link-position-14" title="4 topics" style="font-size: 19.6666666667pt;">Short Code</a>
<a href="http://trlewis.net/tag/sockets/" class="tag-link-13 tag-link-position-15" title="1 topic" style="font-size: 8pt;">Sockets</a>
<a href="http://trlewis.net/tag/threading/" class="tag-link-12 tag-link-position-16" title="1 topic" style="font-size: 8pt;">Threading</a>
<a href="http://trlewis.net/tag/vector-math/" class="tag-link-28 tag-link-position-17" title="1 topic" style="font-size: 8pt;">Vector Math</a>
<a href="http://trlewis.net/tag/xaml/" class="tag-link-27 tag-link-position-18" title="1 topic" style="font-size: 8pt;">XAML</a>
<a href="http://trlewis.net/tag/xml/" class="tag-link-18 tag-link-position-19" title="1 topic" style="font-size: 8pt;">XML</a></div>
</aside>	</div><!-- #primary-sidebar -->
	</div><!-- #secondary -->

		</div><!-- #main -->

		<footer id="colophon" class="site-footer" role="contentinfo">

			
			<div class="site-info">
								<a href="https://wordpress.org/">Proudly powered by WordPress</a>
			</div><!-- .site-info -->
		</footer><!-- #colophon -->
	</div><!-- #page -->

	







</body></html>