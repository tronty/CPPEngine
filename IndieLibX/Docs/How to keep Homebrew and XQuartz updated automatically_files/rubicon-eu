var sociomantic=sociomantic||{enable:function(){sociomantic.sonar.enable()}};sociomantic.sonar=sociomantic.sonar||{enable_callbacks:[],request:{pool:{},add:function(url,load,callback){var sr=sociomantic.sonar.request;var request=sr.item;var random_num=Math.random()+'';var request_id='r'+random_num.replace('.','');url+='&rid='+request_id;sr.pool[request_id]=new request(url,load,callback);return sr.pool[request_id]},item:function(url,load,callback){var self=this;this.url=url;this.load_method=load;this.callback=callback;this.doc=document;this.https=true;this.instance=false;this.response=false;this.status=0;this.timeout=false;this.fallback=false;this.setTimeout=function(length,count){self.timeout={count:count,length:length,object:false}};this.load=function(){if(typeof self.load_method==='function'){self.load_method(self.url,self.doc,self.https);self.status=self.status<1?1:self.status}if(self.timeout){self.timeout.object=setTimeout(function(){if(!self.response){if(self.timeout.count>0){self.timeout.count--;self.status=2;self.load()}else if(self.fallback&&typeof self.fallback==='function'){self.response=true;self.status=4;self.fallback()}}},self.timeout.length)}}}},enable:function(){var so=sociomantic.sonar;for(var i=0;i<so.enable_callbacks.length;i++){if(so.enable_callbacks.hasOwnProperty(i)){var enable_callback=so.enable_callbacks[i];if(typeof enable_callback=='function'){enable_callback();so.enable_callbacks.splice(i,1);i--}}}},response:function(param,response_id){var request_pool=sociomantic.sonar.request.pool;for(var id in request_pool){if(request_pool.hasOwnProperty(id)&&id==response_id){var request=request_pool[id];var callback=request.callback;var instance=request.instance;if(!request.response){if(typeof callback==='function'){request.response=true;request.status=3;if(typeof instance==='string'){callback(param,instance)}else{callback(param)}}}else{}}}}};sociomantic.sonar.ssp=sociomantic.sonar.ssp||{};sociomantic.sonar.ssp['rubicon-eu']=sociomantic.sonar.ssp['rubicon-eu']||{version:'ssp1.33',adpanType:'ssp',admedia:{},admedia_identifier:'sonar-admedium-',admedia_request_properties:['size','cid','city','bog','gid','idfa_hash'],adpan_id:'rubicon-eu',banner_iframes:{},hooks:{},targeting_hosts:[],targeting_hosts_index:0,admedium_request_timeout_count:1,admedium_request_timeout_length:1000,admedium_request_timeout:false,admedium_display_called:{},admedium_fallback_called:{},admedium_response_timeout_count:1,brand_safety_cookie_prefix:'_bs',brand_safety_max_cookies:5,brand_safety_matched:'1',brand_safety_notmatched:'0',brand_safety_timed_out:{},brand_safety_processed:{},brand_safety_jetstart:{},view_request_count:{},view_request_timeout_count:0,view_request_timeout_length:2000,static_domain:'.sociomantic.com/',static_host:'',static_fallback:'',static_host_media:'media/',static_fallback_media:'media/',static_host_static:'static/',static_fallback_static:'static/',static_path_html5:'static_html5/',static_host_css:'css/2011-03-01/',default_css:'css/2011-03-01/default',static_servers:[1],show_ad_metadata:true,show_privacy_i:true,show_logo:true,click_opens_new_window:true,createCSS:true,products:{},products_loaded:{},products_errored:{},modify_metadata_callbacks:[],prepared_banners:[],window_location_timeout_length:0,css_timeout_length:100,css_timeout_count:0,css_timeout_count_total:10,allowSetCookie:true,flashMethod:'displayBannerFlashAsError',required_flash_version:9,swf_properties:'wmode=transparent, allowScriptAccess=always, loop=true, quality=high, menu=false, play=true',click_target:'_blank',ad_url_clicked:'',timespan_new_flag:3600*24*31,click_target_url_token:'[TARGET_URL]',click_target_url_encoded_token:'[TARGET_URL_ENCODED]',privacy_i_url:'http://www.sociomantic.com/privacy/',currency_map:{DEF:{symbol:'',decimal:',',placement:'back',thousand:'.'}},type_map:{0:'none',1:'image',2:'flash'},size_map:{0:{width:'0',height:'0',count:0},1:{width:'300',height:'250',count:6},2:{width:'180',height:'150',count:1},3:{width:'728',height:'90',count:5},4:{width:'160',height:'600',count:6},5:{width:'300',height:'600',count:8},6:{width:'120',height:'60',count:0},7:{width:'88',height:'31',count:0},8:{width:'250',height:'250',count:4},9:{width:'240',height:'400',count:12},10:{width:'336',height:'280',count:6},11:{width:'300',height:'100',count:1},12:{width:'720',height:'300',count:8},13:{width:'468',height:'60',count:4},14:{width:'234',height:'60',count:1},15:{width:'120',height:'90',count:0},16:{width:'120',height:'240',count:2},17:{width:'125',height:'125',count:0},18:{width:'120',height:'600',count:6},19:{width:'88',height:'88',count:0},20:{width:'240',height:'120',count:0},21:{width:'788',height:'326',count:4},60:{width:'320',height:'50',count:4},62:{width:'750',height:'100',count:6},63:{width:'750',height:'200',count:12},67:{width:'930',height:'180',count:12},68:{width:'970',height:'90',count:12},69:{width:'980',height:'120',count:12},70:{width:'250',height:'360',count:12},71:{width:'300',height:'1050',count:12},72:{width:'200',height:'446',count:12},73:{width:'950',height:'90',count:12},74:{width:'300',height:'31',count:12},75:{width:'960',height:'90',count:12},76:{width:'750',height:'300',count:12},77:{width:'970',height:'66',count:12},78:{width:'240',height:'133',count:12},79:{width:'292',height:'30',count:12},80:{width:'580',height:'400',count:12},81:{width:'980',height:'90',count:12},82:{width:'320',height:'100',count:12},83:{width:'220',height:'90',count:12},84:{width:'970',height:'250',count:12},85:{width:'320',height:'480',count:12},86:{width:'768',height:'1024',count:12},87:{width:'480',height:'320',count:12},88:{width:'1024',height:'768',count:12}},enable:function(){var ssp=sociomantic.sonar.ssp['rubicon-eu'];if(!ssp.enabled){ssp.enabled=true;ssp.setStaticUrls();ssp.setTargetingHostsIndex()}ssp.init()},init:function(){var ssp=sociomantic.sonar.ssp['rubicon-eu'];ssp.setAdmedia()},setStaticUrls:function(){var ssp=sociomantic.sonar.ssp['rubicon-eu'];ssp.setStaticHost();var host=ssp.static_host;var fallback=ssp.static_fallback;ssp.static_fallback_static=fallback+ssp.static_fallback_static;ssp.static_fallback_media=fallback+ssp.static_fallback_media;ssp.static_fallback_host_css=fallback+ssp.static_host_css;ssp.default_fallback_css=fallback+ssp.default_css;ssp.static_host_static=host+ssp.static_host_static;ssp.static_host_media=host+ssp.static_host_media;ssp.static_host_css=host+ssp.static_host_css;ssp.default_css=host+ssp.default_css;ssp.static_path_html5=host+ssp.static_path_html5},setStaticHost:function(){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var protocol=ssp.core.getUrlProtocol();var server_count=ssp.static_servers.length;var server_index=(Math.floor(Math.random()*server_count));var fallbackIndex=(server_index+Math.ceil(Math.random()*(server_count-1)))%server_count;var server=ssp.static_servers[server_index];var fallback=ssp.static_servers[fallbackIndex];server=(server<10?'0'+server:server);fallback=(fallback<10?'0'+fallback:fallback);ssp.static_fallback=protocol+ssp.static_host+fallback+ssp.static_domain;ssp.static_host=protocol+ssp.static_host+server+ssp.static_domain},setTargetingHostsIndex:function(){var ssp=sociomantic.sonar.ssp['rubicon-eu'];ssp.targeting_hosts_index=Math.floor(Math.random()*ssp.targeting_hosts.length)},getData:function(){try{var ssp=sociomantic.sonar.ssp['rubicon-eu'];var admedia=ssp.admedia;var data={admedia:[]};if(admedia){var undefinedToNull=function(value){return(typeof value==='undefined'?null:value)};for(var i in admedia){if(admedia.hasOwnProperty(i)){data.admedia.push({'mid':i,'cid':undefinedToNull(admedia[i].cid),'gid':undefinedToNull(admedia[i].gid),'size':undefinedToNull(admedia[i]['size'])})}}}return ssp.core.stringify(data)}catch(e){return'error_getting_admedia_data'}return'no_admedia_data'},getUID:function(id){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var core=ssp.core;if(typeof id!=='undefined'&&typeof ssp.admedia[id]==='object'){var uid=ssp.admedia[id].uid;if(typeof uid==='string'&&uid!==''){return uid}}return core.getCookie()},setUIDCookie:function(uid){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var core=ssp.core;var cookie=core.getCookie();if(ssp.allowSetCookie&&cookie!==uid){core.setCookie(uid)}},setAdmedia:function(){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var core=ssp.core;var admedia=typeof sonar_admedia==='object'?sonar_admedia:false;if(admedia){for(var id in admedia){if(core.hasProperty(admedia,id)){var admedium=admedia[id];if(typeof admedium==='object'&&typeof admedium.ssp==='string'&&admedium.ssp===ssp.adpan_id&&typeof ssp.admedia[id]==='undefined'){ssp.admedia[id]=admedium;ssp.admedia[id].status=0;if(admedium.brand_safety){ssp.startBrandSafety(id,admedium,true)}if(typeof admedium.uid==='string'&&admedium.uid!==''){ssp.admedia[id].uid=admedium.uid;ssp.setUIDCookie(admedium.uid)}delete admedia[id]}}}}ssp.getAdmedia()},getAdmedia:function(){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var core=ssp.core;var admedia=ssp.admedia;var ads=0;var u='undefined';for(var id in admedia){if(core.hasProperty(admedia,id)){var admedium=admedia[id];ads++;if(admedium.status===0){admedium.status=1;ssp.core.getHooks('getAdmedia',admedium);if(typeof admedium.ao===u){ssp.admediaRequest(ssp.getAdmediaRequestProperties(id),id)}else{ssp.contingentDisplay(id,2)}}}}if(!ads){var msg='getAdmedia:no_admedium';ssp.core.reportError('',msg)}},getAdmediaRequestProperties:function(id){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var ao={};var admedium=ssp.admedia[id];var required_props=ssp.admedia_request_properties;for(var i in required_props){if(required_props.hasOwnProperty(i)){var property=required_props[i];if(typeof admedium[property]!=='undefined'){ao[property]=admedium[property]}}}return ao},admediaRequest:function(admedium,id){var so=sociomantic.sonar;var ssp=so.ssp['rubicon-eu'];var core=ssp.core;var cookie=ssp.getUID(id);var load=core.load;var callback=ssp.admediumResponse;var custom_params=typeof ssp.addCustomRequestParams==='function'?ssp.addCustomRequestParams():false;var url=ssp.getTargetingHost()+'admedium?aid='+ssp.adpan_id+(cookie?'&fpc='+cookie:'')+'&ao='+core.fixedEncodeURIComponent(core.stringify(admedium))+(custom_params?custom_params:'');var request=so.request.add(url,load,callback);request.instance=id;request.fallback=function(){ssp.admedia[id].fail_reason=1;ssp.displayFallback(id)};request.setTimeout(ssp.admedium_request_timeout_length,ssp.admedium_request_timeout_count);ssp.brand_safety_jetstart[id]=new Date().getTime();request.load()},getTargetingHost:function(){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var targeting_host=ssp.targeting_hosts[ssp.targeting_hosts_index];ssp.targeting_hosts_index++;if(ssp.targeting_hosts_index>=ssp.targeting_hosts.length){ssp.targeting_hosts_index=0}return targeting_host},admediumResponse:function(admedium,id){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var params={admedium:admedium,id:id};ssp.core.getHooks('admediumResponse',params);try{for(var property in admedium){if(admedium.hasOwnProperty(property)){ssp.admedia[id][property]=admedium[property]}}ssp.contingentDisplay(id,1)}catch(e){ssp.core.reportError(e,'admediumResponse',id)}},contingentDisplay:function(id,jetcomplete){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var admedium=typeof ssp.admedia[id]==='object'?ssp.admedia[id]:false;if(admedium&&admedium.brand_safety){admedium.jetcomplete=jetcomplete;admedium.bs_jetready=new Date().getTime();if(typeof admedium.bs_status!=='undefined'){var matched=admedium.bs_matched;if(typeof matched==='string'){admedium.bs_loadorder=1;ssp.brandSafetyDisplay(id,admedium,matched,8.5)}else{admedium.bs_loadorder=2}}else{ssp.startBrandSafety(id,admedium)}}else{ssp.display(id)}},display:function(id){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var admedium=typeof ssp.admedia[id]==='object'?ssp.admedia[id]:false;var displayed=typeof ssp.admedium_display_called[id]==='undefined'?false:typeof ssp.admedium_display_called[id];if(!displayed){ssp.admedium_display_called[id]=true;ssp.updateVisible(id);ssp.filterAoByUrl(id);if(admedium){if(typeof admedium.ao==='object'){ssp.displayBanner(id,'onloadBannerIframe')}else{admedium.fail_reason=2;ssp.displayFallback(id)}}}},startBrandSafety:function(id,admedium,prejet){var ssp=sociomantic.sonar.ssp['rubicon-eu'];admedium.bs_status=0;if(prejet){admedium.bs_loadorder=0}var matched=ssp.brandSafetyLocalCheck();if(typeof matched==='string'){admedium.bs_status=2;admedium.bs_matched=matched;if(!prejet){ssp.brandSafetyDisplay(id,admedium,matched,8.4)}}else{if(ssp.validBrandSafetyArgs(admedium.brand_safety)){ssp.loadBrandSafety(id,admedium,prejet)}else{admedium.fail_reason=8.1;ssp.displayFallback(id)}}},validBrandSafetyArgs:function(brandSafety){if(typeof brandSafety==='object'){if(typeof brandSafety.config==='object'&&typeof brandSafety.risk==='object'&&typeof brandSafety.url==='string'){return true}}return false},loadBrandSafety:function(id,admedium,prejet){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var core=ssp.core;var brandSafety=admedium.brand_safety;var brandConfig=brandSafety.config;var brandTimeout=ssp.admedium_request_timeout_length;var remainingTime;var jetDuration;if(prejet){remainingTime=brandTimeout}else{jetDuration=new Date().getTime()-ssp.brand_safety_jetstart[id];remainingTime=brandTimeout-jetDuration;remainingTime=(remainingTime<0||remainingTime>brandTimeout)?0:remainingTime;admedium.bs_remain=remainingTime}var callback=function(data){try{ssp.onBrandSafetyData(id,brandSafety,data)}catch(e){var msg='brandSafetyCallback';ssp.core.reportError(e,msg,id)}};sociomantic.sonar.brandsafety.safety_callbacks.push(callback);for(var config in brandConfig){if(core.hasProperty(brandConfig,config)){window[config]=brandConfig[config]}}core.load(brandSafety.url,document,true);core.safeTimeout(function(){ssp.brandSafetyTimeout(id)},remainingTime,'loadBrandSafety',true)},brandSafetyTimeout:function(id){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var admedium=ssp.admedia[id];ssp.brand_safety_timed_out[id]=true;if(typeof ssp.brand_safety_processed[id]==='undefined'){admedium.bs_status=1;ssp.display(id)}},onBrandSafetyData:function(id,brandSafety,data){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var admedium=ssp.admedia[id];var reqRisk=brandSafety.risk;var hasRisk=data.risk;var matched=ssp.brandSafetyMatchRisk(reqRisk,hasRisk);if(ssp.brand_safety_timed_out[id]!==true){ssp.brand_safety_processed[id]=true;if(typeof admedium.jetcomplete==='undefined'){admedium.bs_matched=matched}else{ssp.brandSafetyDisplay(id,admedium,matched,8.3,data)}}ssp.brandSafetySetLocalCache(matched)},brandSafetyDisplay:function(id,admedium,matched,failReason,apiData){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var core=ssp.core;admedium.bs_matched=matched;if(matched===ssp.brand_safety_matched){if(admedium.bs_jetready){admedium.bs_jetwait=new Date().getTime()-admedium.bs_jetready;ssp.display(id)}}else{admedium.fail_reason=failReason;admedium.view_code='';if(apiData){admedium.api_data=core.stringify(apiData)}ssp.displayFallback(id)}},brandSafetyMatchRisk:function(reqRisk,hasRisk){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var core=ssp.core;var matched=ssp.brand_safety_matched;var notMatched=ssp.brand_safety_notmatched;var reqCount=0;var matchCount=0;if(reqRisk&&hasRisk){for(var reqType in reqRisk){if(core.hasProperty(reqRisk,reqType)){var reqLevels=reqRisk[reqType];var riskLevel=hasRisk[reqType]?hasRisk[reqType]:false;reqCount++;if(riskLevel){if(core.isEmpty(reqLevels)||core.inArray(reqLevels,riskLevel)){matchCount++}}else{return notMatched}}}}else{return notMatched}return matchCount===reqCount?matched:notMatched},brandSafetyLocalCheck:function(){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var core=ssp.core;try{var brandSafety=sociomantic.sonar.brandsafety;var location=document.location.href;if(location){var hash=brandSafety.brandSafetyHash().md5(location);var cookieCache=ssp.brandSafetyGetCookie(ssp.brandSafetyGetCookieKey(hash));if(typeof cookieCache==='string'){return cookieCache}}}catch(e){core.reportError(e,'brandSafetyLocalCheck')}return null},brandSafetySetLocalCache:function(matched){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var core=ssp.core;try{var brandSafety=sociomantic.sonar.brandsafety;var location=document.location.href;if(location){ssp.brandSafetyCycleCookies();var hash=brandSafety.brandSafetyHash().md5(location);if(typeof hash==='string'){ssp.brandSafetySetCookie(ssp.brandSafetyGetCookieKey(hash),matched)}}}catch(e){core.reportError(e,'brandSafetySetLocalCache')}},brandSafetyCycleCookies:function(){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var cookieDoc=document.cookie;var regex=new RegExp(' ?'+ssp.brand_safety_cookie_prefix+'[a-f0-9]{32}=[0-1](;|$)','g');var count=cookieDoc.match(regex);if(count){if(count.length>=ssp.brand_safety_max_cookies){var regExHash=/(_bs[a-f0-9]{32})=([0-1])/;var matchHash=count[0].match(regExHash);if(matchHash){ssp.brandSafetySetCookie(matchHash[1],matchHash[2],true)}}}},brandSafetyGetCookieKey:function(key){var ssp=sociomantic.sonar.ssp['rubicon-eu'];return ssp.brand_safety_cookie_prefix+key},brandSafetyGetCookie:function(key){var cookieDoc=document.cookie;var regex='(^|;) ?'+key+'=([^;]*)(;|$)';if(typeof cookieDoc==='string'){var cookie=cookieDoc.match(regex);if(cookie){return cookie[2]}}return false},brandSafetySetCookie:function(key,value,expired){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var core=ssp.core;var domain='';try{if(ssp.allowSetCookie){var host=window.location.hostname.split('.').reverse();if(host.length>2&&host[1].length<=3&&host[0].length<=2){domain='.'+host[2]+'.'+host[1]+'.'+host[0]}else{domain='.'+host[1]+'.'+host[0]}var futdate=new Date();if(expired){futdate=new Date(1980,1,1)}else{var expdate=futdate.getTime();expdate+=core.cookie.lifetime;futdate.setTime(expdate)}document.cookie=key+'='+value+'; domain='+domain+'; expires='+futdate.toUTCString()+'; path=/'}}catch(e){core.reportError(e,'brandSafetySetCookie')}},brandSafetyMsg:function(admedium){var a=admedium;var vers='a';var u='undefined';var e='';var s='.';if(a&&typeof a.bs_status!==u){a.bs_matched=typeof a.bs_matched!==u?a.bs_matched:e;a.bs_loadorder=typeof a.bs_loadorder!==u?a.bs_loadorder:e;a.bs_remain=typeof a.bs_remain!==u?a.bs_remain:e;a.bs_jetwait=typeof a.bs_jetwait!==u?a.bs_jetwait:e;a.bs_msg=vers+s+a.bs_status+s+a.bs_matched+s+a.bs_loadorder+s+a.bs_remain+s+a.bs_jetwait+s}},updateVisible:function(id){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var admedium=ssp.admedia[id];if(typeof admedium.visible==='undefined'){admedium.visible=1}else if(typeof admedium.visible!=='number'){admedium.visible=parseInt(admedium.visible,10)}if(isNaN(admedium.visible)||admedium.visible<1){admedium.visible=ssp.size_map[admedium.size].count}},filterAoByUrl:function(id){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var core=ssp.core;var admedium=ssp.admedia[id];var needed=admedium.visible;if(typeof admedium.ao==='object'){var urls=[];var newAo=[];var ao=admedium.ao;var count=0;var item;var itemsLeft;var itemsNeeded;for(var i in ao){if(core.hasProperty(ao,i)){item=ao[i];itemsLeft=ao.length-count;itemsNeeded=needed-urls.length;if(!core.inArray(urls,item.url)||itemsLeft<=itemsNeeded){urls.push(item.url);newAo.push(item)}count++}}admedium.ao=newAo}},displayBanner:function(id,callback){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var ad_id='sonar-admedium-'+id;var admedium=ssp.admedia[id];var banner_id=ad_id+'-top';var iframe_id=ad_id+'-iframe';var iframe_w='';var iframe_h='';if(document.body!=null){var banner=document.createElement('div');var script=document.getElementById(ad_id);if(script!=null){var parent=script.parentNode;var sizeMap=ssp.size_map[admedium.size];if(typeof admedium.width!=='undefined'||typeof admedium.height!=='undefined'){if(sizeMap.width!==admedium.width||sizeMap.height!==admedium.height){var msg='displayBanner:bad_admedium_size';msg+=':size:'+admedium.size;msg+=':smwidth:'+sizeMap.width;msg+=':width:'+admedium.width;msg+=':smheight:'+sizeMap.height;msg+=':height:'+admedium.height;ssp.core.reportError('',msg,id)}}if(sizeMap.width){iframe_w=' width="'+sizeMap.width+'"'}if(sizeMap.height){iframe_h=' height="'+sizeMap.height+'"'}banner.id=banner_id;banner.innerHTML='<iframe id="'+iframe_id+'" frameborder="0"'+iframe_w+iframe_h+' scrolling="no"'+' style="border:0 none transparent;"'+' onload="sociomantic.sonar.ssp['+"'rubicon-eu'"+'].'+callback+'( \''+id+'\', this )"></iframe>';if(parent.tagName=='HEAD'){document.body.appendChild(banner)}else{parent.insertBefore(banner,script)}}else{admedium.fail_reason=5;ssp.viewRequest(id);var msg='displayBanner:_missing_instance_';ssp.core.reportError('',msg,id)}}else{ssp.core.safeTimeout(function(){ssp.displayBanner(id,callback)},0)}},displayFallback:function(id){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var admedium=ssp.admedia[id];var fallback=ssp.fallback;var fallbackCalled=typeof ssp.admedium_fallback_called[id]==='undefined'?false:ssp.admedium_fallback_called[id];admedium.fail_reason=admedium.fail_reason==='undefined'?0:admedium.fail_reason;if(typeof fallback==='function'&&!fallbackCalled){ssp.admedium_fallback_called[id]=true;fallback(id)}},onloadBannerIframe:function(id,iframe){var ssp=sociomantic.sonar.ssp['rubicon-eu'];try{ssp.storeBannerIframe(id,iframe);var admedium=ssp.admedia[id];var doc=ssp.getIframeDocument(iframe);var placeholder=doc.body;var bannerData=ssp.prepareAdmedium(ssp,ssp.core,admedium,id);if(placeholder!==null){var bannerLoaded=ssp.bannerGenerator(ssp,ssp.core,placeholder,admedium,true,bannerData.products,bannerData.bannerType,id,doc);if(bannerLoaded){ssp.viewRequest(id);ssp.thirdPartyViewRequest(id);ssp.prepared_banners.push(id);ssp.setCssTimeout()}else{}}else{ssp.core.reportError('','Failed_to_get_placeholder',id)}}catch(e){var inst='instance_unknown';try{if(typeof document!=='undefined'&&document!=null){if(document.getElementById('sonar-admedium-'+id)!=null){inst='instance_found'}else{inst='instance_not_found'}}}catch(e1){}ssp.core.reportError(e,'onloadBannerIframe_'+inst,id)}},prepareAdmedium:function(ssp,core,admedium,id){var _u='undefined';function buildLogoUrl(){var url=typeof admedium.url!==_u?admedium.url:admedium.ao[0].url;return buildRedirectionUrl(url,id)}function buildRedirectionUrl(url,id,productItem){return'http://'+core.location.sonar+getClickRequestUrl(buildClickTrackingUrl(url),id,productItem)}function buildClickTrackingUrl(targetUrl){var token=ssp.click_target_url_token;var replaceUrl=targetUrl;var clickCode=typeof admedium.click_code!==_u?admedium.click_code:false;if(clickCode){if(clickCode.indexOf(ssp.click_target_url_encoded_token)!==-1){token=ssp.click_target_url_encoded_token;replaceUrl=core.fixedEncodeURIComponent(targetUrl)}var code_parts=clickCode.split(token);var code_exists=false;for(var i=0;i<code_parts.length;i++){if(code_parts[i]!==''){if(targetUrl.toLowerCase().indexOf(code_parts[i].toLowerCase())!==-1){code_exists=true;break}}}if(!code_exists){return clickCode.replace(token,replaceUrl)}}return targetUrl}function getClickRequestUrl(targetUrl,id,productItem){var cookie=ssp.getUID(id);var a=admedium;var ao=false;if(typeof productItem!==_u){ao=core.stringify([{id:productItem.id,fsize:productItem.fsize}])}var aaid=typeof a.aaid!==_u?a.aaid:false;var aaid_fallback=typeof a.aaid_fallback!==_u?a.aaid_fallback:false;var size=typeof a.size!==_u?a.size:false;var cid=typeof a.cid!==_u?a.cid:false;var cid_failed=typeof a.cid_failed!==_u?a.cid_failed:false;var gid=typeof a.gid!==_u?a.gid:false;var ttype=typeof a.t!==_u?a.t:false;var ref=typeof a.ref!==_u?a.ref:false;var clickUrl=typeof a.click_url!==_u?a.click_url:false;var aog=typeof a.aog!==_u?a.aog:false;var idfa_hash=typeof a.idfa_hash!==_u?a.idfa_hash:false;var timestamp=core.buildCacheBuster('timestamp');var url='action/click?aid='+(ssp.adpan_id!==''?ssp.adpan_id:'')+(cookie?'&fpc='+cookie:'')+(aaid?'&aaid='+(aaid_fallback?aaid_fallback:aaid):'')+(size?'&size='+size:'')+(cid?'&cid='+cid:'')+(cid_failed?'&cid_failed='+cid_failed:'')+(gid?'&gid='+gid:'')+(ttype?'&t='+ttype:'')+(ref?'&ref='+core.fixedEncodeURIComponent(ref):'')+(ao?'&ao='+core.fixedEncodeURIComponent(ao):'')+(aog?'&aog='+aog:'')+(idfa_hash?'&idfa_hash='+idfa_hash:'')+'&cachebuster='+timestamp;if(targetUrl!==''){if(clickUrl&&clickUrl.toLowerCase().substring(0,4)==='http'){url+='&url='+core.fixedEncodeURIComponent(clickUrl+core.fixedEncodeURIComponent(targetUrl))}else{url+='&url='+core.fixedEncodeURIComponent(targetUrl)}}return url}function initBannerData(admedium){var staticItem=null;var html5Item=null;var productCount=0;var products=[];var bannerType=null;var productTotal;if(typeof admedium.visible==='number'){productTotal=admedium.visible}else{productTotal=ssp.size_map[admedium.size].count}for(var i=0,len=admedium.ao.length;i<len;i++){var ad=admedium.ao[i];if(ad.type=='0'){products.push(ad);productCount++}else if(ad.type=='1'&&staticItem===null){staticItem=[ad]}else if(ad.type=='2'&&html5Item===null){html5Item=[ad]}}if(productTotal!==0&&productCount>=productTotal){bannerType=0}else if(staticItem){products=staticItem;bannerType=1}else if(html5Item){products=html5Item;bannerType=2}return{products:products,bannerType:bannerType}}core.getHooks('prepareAdmedium',{admedium:admedium,id:id});var bannerData=initBannerData(admedium);var bannerType=bannerData.bannerType;if(!admedium.logoUrl){admedium.logoUrl=buildLogoUrl()}var products=admedium.ao;var imageFilename;for(var i=0,len=products.length;i<len;i++){var productItem=products[i];if(!productItem.redirectionUrl){productItem.redirectionUrl=buildRedirectionUrl(productItem.url,id,productItem)}if(!productItem.imageSource){if(bannerType===0){imageFilename=productItem.id+'_'+productItem.ftype+'_'+productItem.fsize;productItem.imageFallbackSource=ssp.static_fallback_media+imageFilename;productItem.imageSource=ssp.static_host_media+imageFilename}else if(bannerType===1){imageFilename=productItem.id+'_'+productItem.fsize;productItem.imageFallbackSource=ssp.static_fallback_static+imageFilename;productItem.imageSource=ssp.static_host_static+imageFilename}else if(bannerType===2){imageFilename=productItem.id;productItem.imageSource=ssp.static_path_html5+imageFilename+'/';productItem.imageSource+='?click='+core.fixedEncodeURIComponent(admedium.logoUrl)}}}return bannerData},storeBannerIframe:function(id,iframe){var iframes=sociomantic.sonar.ssp['rubicon-eu'].banner_iframes;if(typeof iframes[id]==='undefined'){iframes[id]=iframe}},getBannerIframe:function(id){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var ad_id='sonar-admedium-'+id;var iframes=ssp.banner_iframes;var iframe=null;if(typeof iframes[id]!=='undefined'){iframe=iframes[id]}else{iframe=document.getElementById(ad_id+'-iframe');if(iframe){ssp.storeBannerIframe(id,iframe)}}if(iframe){return ssp.getIframeDocument(iframe)}return false},getIframeDocument:function(iframe){if(iframe.contentDocument){return iframe.contentDocument}else if(iframe.contentWindow){if(iframe.contentWindow.document){return iframe.contentWindow.document}return iframe.contentWindow}else if(iframe.document){return iframe.document}return false},addCssClass:function(element,className){var regex='(?:^| +)'+className+' *(?= +|$)';if(element&&typeof element.className==='string'&&element.className.match(regex)===null){if(element.className!==''){element.className+=' '}element.className+=className}},createClickLink:function(element,redirectLink,source){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var core=ssp.core;element.target=ssp.click_target;element.href=redirectLink;element.onclick=function(){var newWindow=false;try{newWindow=window.open(redirectLink)}catch(e){core.reportError(e,source+'.window.open')}if(!newWindow){try{window.top.location.href=redirectLink}catch(e){core.reportError(e,source+'.window.top.location.href')}}return false};return element},displayBannerFlashAsError:function(banner_item){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var core=ssp.core;core.reportError('','displayBannerFlashAsError:product_data_'+core.stringify(banner_item))},viewRequest:function(id){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var core=ssp.core;var admedium=ssp.admedia[id];var ao='';if(typeof admedium==='object'){var product_count=0;var product_total=admedium.visible;ao='[';for(var i in admedium.ao){if(admedium.ao.hasOwnProperty(i)){if(i!=0){ao+=','}ao+=core.stringify({id:admedium.ao[i]['id'],fsize:admedium.ao[i]['fsize']});product_count++;if(product_total==product_count){break}}}ao+=']'}ssp.admediaViewRequest(id,ao);ssp.view_request_count[id]=typeof ssp.view_request_count[id]==='number'?ssp.view_request_count[id]++:1},admediaViewRequest:function(id,ao){var so=sociomantic.sonar;var ssp=so.ssp['rubicon-eu'];var core=ssp.core;var cookie=ssp.getUID(id);var u='undefined';var a=ssp.admedia[id];if(typeof a!=='object'){a={};core.reportError('','admediaViewRequest:missing_admedia',id)}var aaid=typeof a.aaid!==u?a.aaid:false;var aaid_fallback=typeof a.aaid_fallback!==u?a.aaid_fallback:false;var size=typeof a.size!==u?a.size:false;var bid=typeof a.bid!==u?a.bid:false;var bam=typeof a.bam!==u?a.bam:0.00;var bwa=typeof a.bwa!==u?a.bwa:false;var cid=typeof a.cid!==u?a.cid:false;var cid_failed=typeof a.cid_failed!==u?a.cid_failed:false;var gid=typeof a.gid!==u?a.gid:false;var ref=typeof a.ref!==u?a.ref:false;var ttype=typeof a.t!==u?a.t:false;var aog=typeof a.aog!==u?a.aog:false;var bog=typeof a.bog!==u?a.bog:false;var idfa_hash=typeof a.idfa_hash!==u?a.idfa_hash:false;ssp.brandSafetyMsg(a);var url=core.location.sonar+'action/view?aid='+(ssp.adpan_id!==''?ssp.adpan_id:'')+(aaid?'&aaid='+(aaid_fallback?aaid_fallback:aaid):'')+(size?'&size='+size:'')+(cid?'&cid='+cid:'')+(cid_failed?'&cid_failed='+cid_failed:'')+(gid?'&gid='+gid:'')+(bid?'&bid='+bid:'')+(bam>0?'&bam='+bam:'')+(bwa?'&bwa='+bwa:'')+(ttype?'&t='+ttype:'')+(cookie?'&fpc='+cookie:'')+(ref?'&ref='+core.fixedEncodeURIComponent(ref):'')+(ao?'&ao='+core.fixedEncodeURIComponent(ao):'')+(typeof a.fail_reason!==u?'&fail_reason='+a.fail_reason:'')+(aog?'&aog='+aog:'')+(bog?'&bog='+bog:'')+(idfa_hash?'&idfa_hash='+idfa_hash:'')+(typeof a.bs_msg!==u?'&bs_msg='+a.bs_msg:'')+(typeof a.api_data!==u?'&api_data='+core.fixedEncodeURIComponent(a.api_data):'')+'&cachebuster='+core.buildCacheBuster();var request=so.request.add(url,core.load,ssp.viewResponse);request.instance=id;request.load()},thirdPartyViewRequest:function(id){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var admedium=ssp.admedia[id];var viewCode=typeof admedium.view_code!=='undefined'?admedium.view_code:false;var tag;if(viewCode){try{var iframe=ssp.getBannerIframe(id);viewCode.url=ssp.core.addUrlProtocol(viewCode.url);if(viewCode.type==='iframe'){tag=iframe.createElement('iframe')}else if(viewCode.type==='image'){tag=iframe.createElement('img')}var cb_num=Math.random()+'';var cb_str=cb_num.replace('.','');tag.src=viewCode.url.replace('[CACHEBUSTER]',cb_str);tag.width='0';tag.height='0';iframe.body.appendChild(tag)}catch(e){var msg='thirdPartyViewRequest';sociomantic.sonar.ssp['rubicon-eu'].core.reportError(e,msg,id)}}},viewResponse:function(cookie){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var core=ssp.core;try{if(ssp.allowSetCookie&&cookie!==''){core.setCookie(cookie)}}catch(e){core.reportError(e,'viewResponse')}},clearBanner:function(id){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var topID='sonar-admedium-'+id+'-top';var topDiv=document.getElementById(topID);if(topDiv){topDiv.parentNode.removeChild(topDiv);delete ssp.banner_iframes[id]}},enableBanner:function(id){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var ad_id='sonar-admedium-'+id;var iframe=ssp.getBannerIframe(id);var banner=iframe.getElementById(ad_id+'-banner');banner.style.display='block'},setCssTimeout:function(){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var callback=function(){ssp.checkCssSheets()};ssp.core.safeTimeout(callback,ssp.css_timeout_length)},checkCssSheets:function(){var ssp=sociomantic.sonar.ssp['rubicon-eu'];for(var i in ssp.prepared_banners){if(ssp.prepared_banners.hasOwnProperty(i)){var id=ssp.prepared_banners[i];var banner_loaded=ssp.checkCssLoaded(id);if(banner_loaded){ssp.prepared_banners.splice(i,1);ssp.enableBanner(id)}}}if(ssp.prepared_banners.length){ssp.setCssTimeout()}},checkCssLoaded:function(id){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var iframe=ssp.getBannerIframe(id);var core=ssp.core;ssp.css_timeout_count++;if(ssp.css_timeout_count>ssp.css_timeout_count_total){return true}try{if(ssp.getStyleValue(id,iframe.body,'font-family')==='Loaded'){return true}}catch(e){var msg='checkCssLoaded: ssp.getStyleValue';core.reportError(e,msg,id);return true}return false},convertHyphenToCamel:function(str){return str.replace(/\-(.)/g,function(m,c){return c.toUpperCase()})},getStyleValue:function(id,el,property){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var iframe=ssp.getBannerIframe(id);var val=false;if(el.currentStyle){property=ssp.convertHyphenToCamel(property);val=el.currentStyle[property]}else if(iframe.defaultView.getComputedStyle){var cs=iframe.defaultView.getComputedStyle(el,null);if(typeof cs!=='undefined'&&cs!=null){val=cs.getPropertyValue(property)}}return val}};sociomantic.sonar.brandsafety=sociomantic.sonar.brandsafety||{safety_callbacks:[],safetycheck:function(data){try{var brand=sociomantic.sonar.brandsafety;var callbacks=brand.safety_callbacks;while(callbacks.length){var callback=callbacks.pop();if(typeof callback==='function'){callback(data)}}}catch(e){sociomantic.sonar.ssp['rubicon-eu'].core.reportError(e,'safetycheck_1.0')}},brandSafetyHash:function(){function md5cycle(x,k){var a=x[0];var b=x[1];var c=x[2];var d=x[3];a=ff(a,b,c,d,k[0],7,-680876936);d=ff(d,a,b,c,k[1],12,-389564586);c=ff(c,d,a,b,k[2],17,606105819);b=ff(b,c,d,a,k[3],22,-1044525330);a=ff(a,b,c,d,k[4],7,-176418897);d=ff(d,a,b,c,k[5],12,1200080426);c=ff(c,d,a,b,k[6],17,-1473231341);b=ff(b,c,d,a,k[7],22,-45705983);a=ff(a,b,c,d,k[8],7,1770035416);d=ff(d,a,b,c,k[9],12,-1958414417);c=ff(c,d,a,b,k[10],17,-42063);b=ff(b,c,d,a,k[11],22,-1990404162);a=ff(a,b,c,d,k[12],7,1804603682);d=ff(d,a,b,c,k[13],12,-40341101);c=ff(c,d,a,b,k[14],17,-1502002290);b=ff(b,c,d,a,k[15],22,1236535329);a=gg(a,b,c,d,k[1],5,-165796510);d=gg(d,a,b,c,k[6],9,-1069501632);c=gg(c,d,a,b,k[11],14,643717713);b=gg(b,c,d,a,k[0],20,-373897302);a=gg(a,b,c,d,k[5],5,-701558691);d=gg(d,a,b,c,k[10],9,38016083);c=gg(c,d,a,b,k[15],14,-660478335);b=gg(b,c,d,a,k[4],20,-405537848);a=gg(a,b,c,d,k[9],5,568446438);d=gg(d,a,b,c,k[14],9,-1019803690);c=gg(c,d,a,b,k[3],14,-187363961);b=gg(b,c,d,a,k[8],20,1163531501);a=gg(a,b,c,d,k[13],5,-1444681467);d=gg(d,a,b,c,k[2],9,-51403784);c=gg(c,d,a,b,k[7],14,1735328473);b=gg(b,c,d,a,k[12],20,-1926607734);a=hh(a,b,c,d,k[5],4,-378558);d=hh(d,a,b,c,k[8],11,-2022574463);c=hh(c,d,a,b,k[11],16,1839030562);b=hh(b,c,d,a,k[14],23,-35309556);a=hh(a,b,c,d,k[1],4,-1530992060);d=hh(d,a,b,c,k[4],11,1272893353);c=hh(c,d,a,b,k[7],16,-155497632);b=hh(b,c,d,a,k[10],23,-1094730640);a=hh(a,b,c,d,k[13],4,681279174);d=hh(d,a,b,c,k[0],11,-358537222);c=hh(c,d,a,b,k[3],16,-722521979);b=hh(b,c,d,a,k[6],23,76029189);a=hh(a,b,c,d,k[9],4,-640364487);d=hh(d,a,b,c,k[12],11,-421815835);c=hh(c,d,a,b,k[15],16,530742520);b=hh(b,c,d,a,k[2],23,-995338651);a=ii(a,b,c,d,k[0],6,-198630844);d=ii(d,a,b,c,k[7],10,1126891415);c=ii(c,d,a,b,k[14],15,-1416354905);b=ii(b,c,d,a,k[5],21,-57434055);a=ii(a,b,c,d,k[12],6,1700485571);d=ii(d,a,b,c,k[3],10,-1894986606);c=ii(c,d,a,b,k[10],15,-1051523);b=ii(b,c,d,a,k[1],21,-2054922799);a=ii(a,b,c,d,k[8],6,1873313359);d=ii(d,a,b,c,k[15],10,-30611744);c=ii(c,d,a,b,k[6],15,-1560198380);b=ii(b,c,d,a,k[13],21,1309151649);a=ii(a,b,c,d,k[4],6,-145523070);d=ii(d,a,b,c,k[11],10,-1120210379);c=ii(c,d,a,b,k[2],15,718787259);b=ii(b,c,d,a,k[9],21,-343485551);x[0]=add32(a,x[0]);x[1]=add32(b,x[1]);x[2]=add32(c,x[2]);x[3]=add32(d,x[3])}function cmn(q,a,b,x,s,t){a=add32(add32(a,q),add32(x,t));return add32((a<<s)|(a>>>(32-s)),b)}function ff(a,b,c,d,x,s,t){return cmn((b&c)|((~b)&d),a,b,x,s,t)}function gg(a,b,c,d,x,s,t){return cmn((b&d)|(c&(~d)),a,b,x,s,t)}function hh(a,b,c,d,x,s,t){return cmn(b^c^d,a,b,x,s,t)}function ii(a,b,c,d,x,s,t){return cmn(c^(b|(~d)),a,b,x,s,t)}function md51(s){var n=s.length;var state=[1732584193,-271733879,-1732584194,271733878];var i;for(i=64;i<=s.length;i+=64){md5cycle(state,md5blk(s.substring(i-64,i)))}s=s.substring(i-64);var tail=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(i=0;i<s.length;i++){tail[i>>2]|=s.charCodeAt(i)<<((i%4)<<3)}tail[i>>2]|=0x80<<((i%4)<<3);if(i>55){md5cycle(state,tail);for(i=0;i<16;i++){tail[i]=0}}tail[14]=n*8;md5cycle(state,tail);return state}function md5blk(s){var md5blks=[];var i;for(i=0;i<64;i+=4){md5blks[i>>2]=s.charCodeAt(i)+(s.charCodeAt(i+1)<<8)+(s.charCodeAt(i+2)<<16)+(s.charCodeAt(i+3)<<24)}return md5blks}var hex_chr='0123456789abcdef'.split('');function rhex(n){var s='';var j=0;for(;j<4;j++){s+=hex_chr[(n>>(j*8+4))&0x0F]+hex_chr[(n>>(j*8))&0x0F]}return s}function hex(x){for(var i=0;i<x.length;i++){x[i]=rhex(x[i])}return x.join('')}function md5(s){return typeof s==='string'?hex(md51(s)):false}var add32=function(a,b){return(a+b)&0xFFFFFFFF};if(md5('hello')!=='5d41402abc4b2a76b9719d911017c592'){add32=function(x,y){var lsw=(x&0xFFFF)+(y&0xFFFF),msw=(x>>16)+(y>>16)+(lsw>>16);return(msw<<16)|(lsw&0xFFFF)}}return{md5:md5}}};sociomantic.sonar.enable_callbacks.push(sociomantic.sonar.ssp['rubicon-eu'].enable);sociomantic.sonar.ssp['rubicon-eu'].core=sociomantic.sonar.ssp['rubicon-eu'].core||{cookie:{lifetime:((3600*24000)*365)*2,optoutLifetime:((3600*24000)*365)*5,optoutRegex:'(^|;) ?sonar_optout=([^;]*)(;|$)',regex:'(^|;) ?__sonar=([^;]*)(;|$)'},sonarIdRegex:/(\[SONAR-ID\])/g,protocolToken:/(\[PROTOCOL\])/g,protocolEncodedToken:/(\[PROTOCOL_ENCODED\])/g,msgCountMax:10,msgCount:0,htmlTypes:['iframe','img','script'],location:{sonar:'',debug:'',trace:'',rtb:[]},hooks:{},getCookie:function(){var cookieDoc=document.cookie;if(typeof cookieDoc==='string'){var core=sociomantic.sonar.ssp['rubicon-eu'].core;var cookie=cookieDoc.match(core.cookie.regex);if(cookie){return cookie[2]}}return false},setCookie:function(value){var core=sociomantic.sonar.ssp['rubicon-eu'].core;var domain='';var regex=/\D/;try{if(typeof value!=='string'||value.match(regex)!==null){core.reportError('','setCookie_bad_format')}var host=window.location.hostname.split('.').reverse();if(host.length>2&&host[1].length<=3&&host[0].length<=2){domain='.'+host[2]+'.'+host[1]+'.'+host[0]}else{domain='.'+host[1]+'.'+host[0]}var futdate=new Date();var expdate=futdate.getTime();expdate+=core.cookie.lifetime;futdate.setTime(expdate);document.cookie='__sonar='+value+'; domain='+domain+'; expires='+futdate.toUTCString()+'; path=/'}catch(e){core.reportError(e,'setCookie')}},createHtmlElement:function(src,type){var core=sociomantic.sonar.ssp['rubicon-eu'].core;type=core.getValidType(type);var el=document.createElement(type);el.src=src;el.width=0;el.height=0;el.style.cssText='display:none !important;width:0 !important;height:0 !important;';core.appendElement(el)},getValidType:function(type){var core=sociomantic.sonar.ssp['rubicon-eu'].core;if(typeof type==='string'&&core.inArray(core.htmlTypes,type)){return type}return'img'},appendElement:function(element){var scripts=document.getElementsByTagName('script');if(scripts.length>0){var last=scripts[scripts.length-1];last.parentNode.insertBefore(element,last.nextSibling)}else if(document.body!==null&&typeof document.body!=='undefined'){document.body.appendChild(element)}},getHooks:function(hookGroup,param){var core=sociomantic.sonar.ssp['rubicon-eu'].core;var allHooks=core.hooks;if(typeof allHooks[hookGroup]==='object'){var hooks=allHooks[hookGroup];for(var i in hooks){if(core.hasProperty(hooks,i)){var hook=hooks[i];if(typeof hook==='function'){if(typeof param!=='undefined'){hook(param)}else{hook()}}}}}},setHooks:function(hookGroup,newHook,hookId){var core=sociomantic.sonar.ssp['rubicon-eu'].core;var allHooks=core.hooks;hookId=hookId||Math.random()+'';allHooks[hookGroup]=allHooks[hookGroup]||{};if(typeof newHook==='function'&&typeof allHooks[hookGroup][hookId]!=='function'){allHooks[hookGroup][hookId]=newHook}},stringify:function(obj){var core=sociomantic.sonar.ssp['rubicon-eu'].core;var t=typeof(obj);if(t!=='object'||obj===null){if(t==='string'){obj='"'+obj+'"'}return String(obj)}else{var n;var v;var json=[];var arr=(obj&&obj.constructor==Array);for(n in obj){if(core.hasProperty(obj,n)){v=obj[n];t=typeof(v);if(t==='string'){v='"'+v+'"'}else if(t==='object'&&v!==null){v=core.stringify(v)}if(t!=='undefined'){json.push((arr?'':'"'+n+'":')+String(v))}else{core.reportError('','stringify_undefined_value_in_'+n)}}}return(arr?'[':'{')+String(json)+(arr?']':'}')}},fixedEncodeURIComponent:function(str){var encodedStr=encodeURIComponent(str);var safeEscape=function(v){return escape(v)};encodedStr=encodedStr.replace(/[!'()]/g,safeEscape);encodedStr=encodedStr.replace(/\*/g,'%2A');return encodedStr},reportError:function(e,functionName,id,location){var adpan=sociomantic.sonar.ssp['rubicon-eu'];var core=adpan.core;var u='undefined';var c=++core.msgCount;if(c>core.msgCountMax&&(c&(c-1))){return}functionName=(typeof functionName!==u&&functionName!=='')?functionName:'unknown_function';var errorParamsSep='&';var adpanData=typeof adpan.getData==='function'?adpan.getData():'no_admedia_data';var errorParamsArray=[];var viewRequests=core.stringify(adpan.view_request_count);if(typeof e!=='object'){e={name:u,message:u,lineNumber:u,stack:u}}errorParamsArray.push('e='+encodeURIComponent(e.name),'a='+adpan.adpan_id,'v='+adpan.version,'f='+encodeURIComponent(functionName),'k='+id,'d='+encodeURIComponent(adpanData),'c='+core.getCookie(),'h='+encodeURIComponent(window.location.href),'i='+encodeURIComponent(viewRequests),'l='+encodeURIComponent(e.lineNumber),'m='+encodeURIComponent(e.message),'x='+encodeURIComponent(c),'s='+encodeURIComponent(e.stack));var errorParams=core.joinErrorParam(errorParamsArray,errorParamsSep);core.reportMsg(errorParams,location)},reportTrace:function(e,functionName,id){var adpan=sociomantic.sonar.ssp['rubicon-eu'];var core=adpan.core;core.reportError(e,functionName,id,core.location.trace)},joinErrorParam:function(params,errorParamsSep){var result='';for(var i=0;i<params.length;i++){if(params[i]!==''){result+=params[i];result+=errorParamsSep}}return result},reportMsg:function(msg,location){var core=sociomantic.sonar.ssp['rubicon-eu'].core;location=typeof location==='string'?location:core.location.debug;var errorString=core.getUrlProtocol()+location+msg+'&cachebuster='+core.buildCacheBuster();core.createHtmlElement(errorString)},load:function(url,doc,https){var core=sociomantic.sonar.ssp['rubicon-eu'].core;var s=doc.createElement('script');s.type='text/javascript';s.async=true;s.src=(https?core.getUrlProtocol():'http://')+url;core.appendElement(s)},hasProperty:function(obj,property){return Object.prototype.hasOwnProperty.call(obj,property)},getUrlProtocol:function(altDoc){var doc=typeof altDoc!=='undefined'?altDoc:document;return'https:'===doc.location.protocol?'https://':'http://'},addUrlProtocol:function(url,altDoc){var core=sociomantic.sonar.ssp['rubicon-eu'].core;var newProtocol=core.getUrlProtocol(altDoc);if(typeof url==='string'){var i=url.indexOf('\/\/');if((i>=0)&&(i<9)){url=url.replace(/^.*?\/\//,newProtocol)}else{url=newProtocol+url}}return url},buildCacheBuster:function(type){var cb;switch(type){case'timestamp':cb=Math.round(new Date().getTime()/1000)+'';break;default:cb=Math.random()+''}return cb.replace('.','')},isEmpty:function(obj){for(var prop in obj){if(obj.hasOwnProperty(prop)){return false}}return true},inArray:function(ar,item){var core=sociomantic.sonar.ssp['rubicon-eu'].core;for(var i in ar){if(core.hasProperty(ar,i)&&ar[i]===item){return true}}return false},getLanguage:function(){var core=sociomantic.sonar.ssp['rubicon-eu'].core;var browserLang=false;try{browserLang=navigator.userLanguage||navigator.language||'';browserLang=browserLang.toLowerCase()}catch(e){core.reportError(e,'.getLanguage')}return browserLang!==''?browserLang:false},safeTimeout:function(callback,timeout,message,logErrors){var core=sociomantic.sonar.ssp['rubicon-eu'].core;timeout=typeof timeout==='number'&&timeout>0?timeout:0;return setTimeout(function(){try{callback()}catch(e){if(logErrors){var msg='safeTimeout';msg+=message?'_'+message:'';core.reportError(e,msg)}}},timeout)}};sociomantic.sonar.ssp['rubicon-eu'].bannerGenerator=sociomantic.sonar.ssp['rubicon-eu'].bannerGenerator||function bannerGenerator(ssp,core,parent,admedium,createLinks,products,bannerType,id,doc){var _admedium=admedium;var _ssp=ssp;var _core=core;var _id=id;var _fx=_ssp.fx;var _doc=doc||document;var _parent=parent;var _u='undefined';var _s='string';var _o='object';var _sonarAdIdPrefix='sonar-admedium-';var _bannerDivId=_sonarAdIdPrefix+_id+'-banner';var _productDivId=_sonarAdIdPrefix+_id+'-products';var _productItemIdPrefix=_sonarAdIdPrefix+_id+'-banner-item-';var _metaPrefix='metadata-';var _defaultCSS='sonar_default_css';var _specificCSS=null;var _products=products;var _bannerType=bannerType;var _bannerDiv=null;var _productsErrored=[];var _productsLoaded=[];_ssp.products_loaded[_id]=_productsLoaded;var _createLinks=createLinks;var _disableGifs=typeof _admedium.disableGifs==='boolean'?_admedium.disableGifs:false;function setCSS(bannerType){if(_ssp.createCSS){var validGid=false;loadCSS(_ssp.default_css,_defaultCSS,_ssp.default_fallback_css);if(typeof _admedium.gid_fallback!==_u){validGid=_admedium.gid_fallback}else if(typeof _admedium.gid!==_u){validGid=_admedium.gid}if(validGid&&bannerType===0){var cssSrc=_ssp.static_host_css+validGid;var cssFallbackSrc=_ssp.static_fallback_host_css+validGid;_specificCSS='sonar_'+validGid+'_css';loadCSS(cssSrc,_specificCSS,cssFallbackSrc)}}}function loadCSS(cssSrc,cssLinkId,cssFallbackSrc){if(!cssLoaded(cssLinkId)){var htmlHead=_doc.getElementsByTagName('head')[0];var link=_doc.createElement('link');link.type='text/css';link.rel='stylesheet';link.media='screen';link.href=cssSrc+'.css';link.id=cssLinkId;link.onerror=function(){try{var fallback=_doc.createElement('link');fallback.type='text/css';fallback.rel='stylesheet';fallback.media='screen';fallback.href=cssFallbackSrc+'.css';link.parentNode.insertBefore(fallback,link);link.parentNode.removeChild(link);fallback.id=cssLinkId}catch(e){_core.reportError(e,'loadCSS.link.onerror',_id)}};if(typeof htmlHead===_u){htmlHead=_doc.createElement('head');_doc.body.parentNode.insertBefore(htmlHead,_doc.body)}htmlHead.appendChild(link)}}function cssLoaded(cssLinkId){if(_doc&&_doc.getElementById(cssLinkId)){return true}return false}function createBannerDiv(){var bannerDiv=_doc.createElement('div');bannerDiv.id=_bannerDivId;_ssp.addCssClass(bannerDiv,'banner');_ssp.addCssClass(bannerDiv,'banner-size-'+admedium.size);_ssp.addCssClass(_parent,'body-size-'+admedium.size);_ssp.addCssClass(_parent,'css-fully-loaded');bannerDiv.style.display='none';_parent.appendChild(bannerDiv);return bannerDiv}function createClickHolder(parentElement,product){var clickholder=_doc.createElement('a');var clickCls='clickholder-'+(product?'products':'banner');_ssp.addCssClass(clickholder,clickCls);if(_bannerType===2){_ssp.addCssClass(clickholder,'clickholder-html5')}if(_createLinks){_ssp.createClickLink(clickholder,_admedium.logoUrl,clickCls)}parentElement.appendChild(clickholder)}function createPrivacyI(parentElement){var privacyILink=null;if(_ssp.show_privacy_i){var clickUrl=typeof _admedium.click_url!==_u?_admedium.click_url:false;privacyILink=_doc.createElement('a');var lang=_core.getLanguage();lang=lang?lang:'en';var langShort=lang.substr(0,2);langShort=langShort===lang?false:langShort;var targetUrl=_ssp.privacy_i_url+lang+'/';var redirectionUrl;if(clickUrl&&clickUrl.toLowerCase().substring(0,4)==='http'){redirectionUrl=clickUrl+_core.fixedEncodeURIComponent(targetUrl)}else{redirectionUrl=targetUrl}if(_createLinks){_ssp.createClickLink(privacyILink,redirectionUrl,'privacyI')}_ssp.addCssClass(privacyILink,'privacy-i');_ssp.addCssClass(privacyILink,'privacy-i-'+lang);if(langShort){_ssp.addCssClass(privacyILink,'privacy-i-'+langShort)}parentElement.appendChild(privacyILink)}return privacyILink}function resizeStaticBanner(bannerDiv){var method='resizeBannerCategory';try{if(typeof _products[0]!==_u){var product=_products[0];if(typeof _ssp.size_map[product.fsize]!==_u){bannerDiv.style.width=_ssp.size_map[product.fsize].width;bannerDiv.style.height=_ssp.size_map[product.fsize].height}else{var msg=method+'_WrongFsize_'+product.fsize+'_productId_'+product.id;_core.reportError('',msg,_id)}}}catch(e){_core.reportError(e,method,_id)}}function createProductDiv(parentElement){var productsDiv=_doc.createElement('div');productsDiv.id=_productDivId;_ssp.addCssClass(productsDiv,'products');parentElement.appendChild(productsDiv);_ssp.addCssClass(parentElement,'product-banner');return productsDiv}function createAllProductItems(parentElement,products){for(var i=0,len=products.length;i<len;i++){var productItem=products[i];var itemIndex=i+1;var productItemLink=createProductLink(parentElement,productItem,itemIndex);createProductMetaData(productItemLink,productItem,itemIndex)}}function createProductLink(parentElement,productItem,productIndex){var productItemLink=_doc.createElement('a');var itemSize=productItem.fsize;var productItemId=_productItemIdPrefix+productIndex;productItemLink.id=productItemId;_ssp.addCssClass(productItemLink,'banner-item-size-'+itemSize);_ssp.addCssClass(productItemLink,'item');if(_createLinks){_ssp.createClickLink(productItemLink,productItem.redirectionUrl,'ProductLink')}parentElement.appendChild(productItemLink);return productItemLink}function createProductMetaData(parentElement,productItem,productIndex){var productItemType=productItem.ftype;if(productItemType===1){createProductImage(parentElement,productItem,productIndex);if(productItem.type===0){displayMetadata(parentElement,productItem)}}else if(productItemType===2){var flashMethod;if(typeof _ssp.flashMethod==='string'&&typeof _ssp[_ssp.flashMethod]==='function'){flashMethod=_ssp.flashMethod}else{flashMethod='displayBannerFlashAsError'}_ssp[flashMethod](productItem,_id,productIndex)}}function createProductImage(parentElement,productItem,productIndex){var productImageSpan=_doc.createElement('span');var productImageImg=_doc.createElement('img');var imageSource=productItem.imageSource;var imageFallbackSource=productItem.imageFallbackSource;_ssp.addCssClass(productImageSpan,'banner-item-image');if(!_createLinks){_productsLoaded.push(productIndex);productImageSpan.style.backgroundImage='url('+imageSource+')';addBannerItemClasses(parentElement,productIndex)}else{productImageRetry(parentElement,productItem,productIndex,productImageImg,productImageSpan,imageFallbackSource);productImageLoaded(parentElement,productItem,productIndex,productImageImg,productImageSpan,imageSource)}productImageSpan.appendChild(productImageImg);parentElement.appendChild(productImageSpan);if(_bannerType===1&&_disableGifs){createStaticImage(productImageSpan,'banner-item-image',imageSource)}productImageImg.src=imageSource}function productImageRetry(parentElement,productItem,productIndex,productImageImg,productImageSpan,imageFallbackSource){productImageImg.onerror=function(){try{var newProductImageImg=_doc.createElement('img');newProductImageImg.onerror=function(){productImageRemove(parentElement,newProductImageImg,productIndex)};productImageLoaded(parentElement,productItem,productIndex,newProductImageImg,productImageSpan,imageFallbackSource);productImageSpan.removeChild(productImageImg);productImageSpan.appendChild(newProductImageImg);newProductImageImg.src=imageFallbackSource}catch(e){_core.reportError(e,'productImageRetry.productImageImg.onerror',_id)}}}function productImageLoaded(parentElement,productItem,productIndex,productImageImg,productImageSpan,imageSource){productImageImg.onload=function(){try{productImageSpan.style.backgroundImage='url('+imageSource+')';_productsLoaded.push(productIndex);if(typeof _fx===_o){var valid=typeof productItem.valid!==_u?productItem.valid:false;_fx.enable(_id,productIndex,valid)}checkBannerItems()}catch(e){_core.reportError(e,'productImageLoaded.productImageImg.onload',_id)}}}function productImageRemove(parentElement,productImageImg,productIndex){try{productImageImg.parentNode.removeChild(productImageImg);parentElement.parentNode.removeChild(parentElement);_productsErrored.push(productIndex);checkBannerItems()}catch(e){_core.reportError(e,'bannerImageRemove',_id)}}function displayMetadata(parentElement,productItem){if(_ssp.show_ad_metadata){displayMetadataElement(parentElement,productItem,'manufacturer');displayMetadataElement(parentElement,productItem,'title');displayMetadataElement(parentElement,productItem,'text');if(typeof _admedium.c2a!==_u&&_admedium.c2a!==''){createMetadataElement(parentElement,_metaPrefix+'c2a',_admedium.c2a)}if(typeof productItem.currency!==_u||typeof productItem.price!==_u){var cfmt=typeof _admedium.cfmt!==_u?_admedium.cfmt:0;createPriceMetadata(parentElement,productItem,cfmt)}if(typeof productItem.createtime!==_u&&isProductNew(productItem.createtime)){createMetadataElement(parentElement,_metaPrefix+'new-icon','Neu')}}}function isProductNew(createtime){var date=new Date();var currentTime=parseInt(date.getTime()/1000,10);var newTime=currentTime-_ssp.timespan_new_flag;if(createtime>newTime){return true}return false}function checkBannerItems(){var productsTotal=_products.length;var erroredTotal=_productsErrored.length;var loadedTotal=_productsLoaded.length;var visible=typeof _admedium.visible!==_u?_admedium.visible:1;if((erroredTotal+loadedTotal)>=productsTotal){if(loadedTotal<visible){_admedium.fail_reason=6;_ssp.displayFallback(_id)}else{onAllProductImagesLoaded();if(sociomantic&&typeof sociomantic.onBannerLoadComplete==='function'){try{sociomantic.onBannerLoadComplete(_id,_admedium)}catch(e){_core.reportError(e,'onBannerLoadComplete',_id)}}}}}function onAllProductImagesLoaded(){_productsLoaded.sort(function(a,b){return a-b});for(var i=0,len=_productsLoaded.length;i<len;i++){var productIndex=_productsLoaded[i];var productItemId=_productItemIdPrefix+productIndex;var productItemLink=_doc.getElementById(productItemId);addBannerItemClasses(productItemLink,productIndex)}}function addBannerItemClasses(productItemLink,index){var last=parseInt(_admedium.visible,10);_ssp.addCssClass(productItemLink,'item-'+index);if(index%2===0){_ssp.addCssClass(productItemLink,'item-even')}else{_ssp.addCssClass(productItemLink,'item-odd')}if(index===1){_ssp.addCssClass(productItemLink,'item-first')}if(index===last){_ssp.addCssClass(productItemLink,'item-last')}}function createPriceMetadata(parentElement,productItem,cfmt){var price=parseFloat(productItem.price);var sprice=typeof productItem.sprice!=='undefined'?parseFloat(productItem.sprice):false;var currency;if(typeof _ssp.currency_map[productItem.currency]!==_u){currency=_ssp.currency_map[productItem.currency];currency.shortcode=productItem.currency}else{currency=ssp.currency_map['DEF'];currency.shortcode='DEF'}if(sprice&&(sprice>0)&&(sprice<price)){var reduction=Math.round((1-(sprice/price))*100);reduction=reduction===0?1:reduction;var saleIcon=createMetadataElement(parentElement,_metaPrefix+'sale-icon','');createMetadataElement(saleIcon,_metaPrefix+'sale-icon-minus','-');createMetadataElement(saleIcon,_metaPrefix+'sale-icon-number',reduction);createMetadataElement(saleIcon,_metaPrefix+'sale-icon-percentage','%');var salePrice=createPrice(parentElement,_metaPrefix+'sale-price',productItem.sprice,cfmt,currency);var oldPrice=createPrice(parentElement,_metaPrefix+'old-price',productItem.price,cfmt,currency);if(reduction<5){_ssp.addCssClass(saleIcon,_metaPrefix+'lowpercent-sale-icon');_ssp.addCssClass(salePrice,_metaPrefix+'lowpercent-sale-price');_ssp.addCssClass(oldPrice,_metaPrefix+'lowpercent-old-price')}}else{var el=createPrice(parentElement,_metaPrefix+'price',productItem.price,cfmt,currency);if(el&&price===0){_ssp.addCssClass(el,_metaPrefix+'zero-price')}}}function createPrice(parentElement,metaName,metaValue,cfmt,currency){var result=false;switch(cfmt){case 1:result=createPriceElement(parentElement,metaName,metaValue,currency,0,0);break;case 2:result=createPricePartsElements(parentElement,metaName,metaValue,currency,0);break;case 3:result=createPriceElement(parentElement,metaName,metaValue,currency,1,1);break;case 4:result=createPriceElement(parentElement,metaName,metaValue,currency,0,1);break;case 5:result=createPricePartsElements(parentElement,metaName,metaValue,currency,1);break;default:result=createPriceElement(parentElement,metaName,metaValue,currency,1,0)}return result}function createPriceElement(parentElement,metaName,metaValue,currency,decimal,thousand){metaValue=metaValue+'';var numberArray=metaValue.split('.');var originalInteger=numberArray[0];var originalDecimal=numberArray.length>1?numberArray[1]:'00';var newPrice=originalInteger;if(thousand===1){newPrice=addThousandSeparator(originalInteger,currency.thousand)}if(decimal===1){if(originalDecimal.length===1){originalDecimal+='0'}newPrice+=currency.decimal+originalDecimal}if(currency.placement==='front'){newPrice=currency.symbol+' '+newPrice}else{newPrice+=' '+currency.symbol}return createMetadataElement(parentElement,metaName,newPrice)}function createPricePartsElements(parentElement,metaName,metaValue,currency,thousand){metaValue=metaValue+'';var numberArray=metaValue.split('.');var originalInteger=numberArray[0];var originalDecimal=numberArray.length>1?numberArray[1]:'';var newInteger=originalInteger;var pricePartElement=createMetadataElement(parentElement,metaName+'-parts','');if(typeof currency.shortcode===_s){_ssp.addCssClass(pricePartElement,_metaPrefix+'price-parts-'+currency.shortcode.toLowerCase())}if(thousand===1){newInteger=addThousandSeparator(originalInteger,currency.thousand)}if(currency.placement==='front'){createMetadataElement(pricePartElement,metaName+'-currency-left',currency.symbol)}createMetadataElement(pricePartElement,metaName+'-integer',newInteger);createMetadataElement(pricePartElement,metaName+'-separator',currency.decimal);createMetadataElement(pricePartElement,metaName+'-decimal',originalDecimal);if(currency.placement==='back'){createMetadataElement(pricePartElement,metaName+'-currency-right',currency.symbol)}return pricePartElement}function addThousandSeparator(integer,thousand){var integerString=integer;var regex=/(\d+)(\d{3})/;while(regex.test(integerString)){integerString=integerString.replace(regex,'$1'+thousand+'$2')}return integerString}function createLogo(parentElement){if(_ssp.show_logo){var logo=_doc.createElement('a');_ssp.addCssClass(logo,'logo');if(_createLinks){_ssp.createClickLink(logo,_admedium.logoUrl,'createLogo')}parentElement.appendChild(logo);if(_disableGifs){var host=_ssp.static_host_static.replace('/static','/logo');var path=host+_admedium.gid+'_'+_admedium.size+'?'+_core.buildCacheBuster();createStaticImage(parentElement,'logo',path,_admedium.logoUrl)}}}function createStaticImage(parentElement,className,filePath,clickLink){try{var canvas=document.createElement('canvas');var context;if(!!(canvas.getContext&&(context=canvas.getContext('2d')))){var img=new Image();_ssp.addCssClass(canvas,className);img.addEventListener('load',function(){if(this.complete){canvas.width=this.width;canvas.height=this.height;context.drawImage(this,0,0,this.width,this.height)}},false);img.src=filePath;canvas.setAttribute('style','cursor:pointer;');if(clickLink){_ssp.createClickLink(canvas,clickLink,'canvas-'+className)}parentElement.appendChild(canvas);return canvas}}catch(e){}}function displayMetadataElement(parentElement,productItem,metaName){var productItemMeta=productItem[metaName];if(typeof productItemMeta!==_u&&productItemMeta!==''){return createMetadataElement(parentElement,_metaPrefix+metaName,productItemMeta)}return false}function createMetadataElement(parentElement,metaName,metaValue){var el=_doc.createElement('span');_ssp.addCssClass(el,metaName);el.appendChild(_doc.createTextNode(metaValue));parentElement.appendChild(el);return el}function addHtml5Banner(bannerDiv,admedium){var method='addHtml5Banner';try{var iframe=_doc.createElement('iFrame');iframe.id='banner-html5-iframe-'+_id;iframe.scrolling='no';iframe.frameBorder='0';iframe.style.border='0 none transparent';_ssp.addCssClass(iframe,'banner-html5-iframe');var sizeMap=_ssp.size_map[admedium.size];if(sizeMap.width){iframe.width=sizeMap.width}if(sizeMap.height){iframe.height=sizeMap.height}bannerDiv.appendChild(iframe);iframe.src=admedium.ao[0].imageSource}catch(e){_core.reportError(e,method,_id)}}function enableBanner(banner){banner.style.display='block'}try{if(typeof _admedium.cm==='object'){var cm=_admedium.cm;for(var cur in cm){if(cm.hasOwnProperty(cur)){if(typeof _ssp.currency_map[cur]==='undefined'){_ssp.currency_map[cur]=cm[cur]}}}}if(_bannerType===null){_admedium.fail_reason=3;_ssp.displayFallback(_id);return false}else{if(_createLinks){setCSS(_bannerType)}_bannerDiv=createBannerDiv();createClickHolder(_bannerDiv);createPrivacyI(_bannerDiv);var productItemParent;if(_bannerType===1){productItemParent=_bannerDiv;_ssp.addCssClass(_bannerDiv,'banner-category');resizeStaticBanner(_bannerDiv);createAllProductItems(productItemParent,_products)}else if(_bannerType===2){productItemParent=_bannerDiv;_ssp.addCssClass(_bannerDiv,'banner-html5');addHtml5Banner(_bannerDiv,_admedium)}else{productItemParent=createProductDiv(_bannerDiv);createClickHolder(productItemParent,true);createLogo(_bannerDiv);createAllProductItems(productItemParent,_products)}enableBanner(_bannerDiv)}}catch(e){_ssp.displayFallback(_id);_core.reportError(e,'bannerGenerator',_id);return false}ssp.core.getHooks('bannerGenerator',_doc);return true};sociomantic.sonar.ssp['rubicon-eu'].fx=sociomantic.sonar.ssp['rubicon-eu'].fx||{admediums:{},runtime_max:0,runtime_length:{},runtime:{},start_time:{},cycle_products:{},cycling_products:{},cycle_products_last_target:{},cycle_products_timeout_length:2500,fade_interval:20,count_down_products:{},counting_down_products:{},count_down_timeout_length:1000,billboarding:{},billboard_timeout_length:6365,billboard_first_timeout_length:7200,billboards:{},enable:function(id,i,valid){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var am=ssp.admedia[id];var fx=ssp.fx;var fx_setting=typeof am.fx!=='undefined'?am.fx:0;fx.setRuntimeLength(id);fx.setRuntime(id);fx.admediums[id]=id;fx.cycle_products[id]=true;fx.count_down_products[id]=true;if(am.anim===0){fx.disable(id)}switch(fx_setting){case 1:fx.cycle_products[id]=false;if(valid){fx.countDownInit(id,i,valid,false)}break;case 2:if(valid){fx.countDownInit(id,i,valid,false)}break;case 3:fx.billboardInit(id,false);break;case 4:fx.cycle_products[id]=false;break;case 5:fx.cycle_products[id]=false;if(valid){fx.countDownInit(id,i,valid,true)}break;case 6:if(valid){fx.countDownInit(id,i,valid,true)}break;case 7:fx.billboardInit(id,true);break;case 0:break;default:break}fx.enableDefault(id)},enableDefault:function(id){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var core=ssp.core;var fx=ssp.fx;core.safeTimeout(function(){fx.cycleProductsInit(id)},fx.cycle_products_timeout_length)},disable:function(id){var fx=sociomantic.sonar.ssp['rubicon-eu'].fx;fx.cycle_products[id]=false;fx.count_down_products[id]=false;if(typeof fx.billboards[id]!=='undefined'){fx.billboards[id].enabled=false}},setRuntimeLength:function(id){var fx=sociomantic.sonar.ssp['rubicon-eu'].fx;fx.runtime_length[id]=fx.runtime_max},setRuntime:function(id){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var core=ssp.core;var fx=ssp.fx;var rt_length=fx.runtime_length[id];var rt_timeout=fx.runtime[id];if(rt_length>0&&(typeof rt_timeout==='undefined'||rt_timeout==='paused')){fx.start_time[id]=parseInt((new Date()).getTime(),10);fx.runtime[id]=core.safeTimeout(function(){fx.disable(id)},rt_length)}},cycleProductsInit:function(id){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var fx=ssp.fx;var admedium=ssp.admedia[id];var visible_total=admedium.visible;if(fx.cycle_products[id]&&typeof fx.cycling_products[id]==='undefined'&&typeof ssp.products_loaded[id]!=='undefined'&&ssp.products_loaded[id].length>visible_total){fx.cycling_products[id]=true;fx.cycle_products_last_target[id]=0;ssp.products_loaded[id].sort(fx.cycleProductsSort);fx.cycleProducts(id)}},cycleProductsSort:function(a,b){return a-b},cycleProducts:function(id){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var fx=ssp.fx;if(fx.cycle_products[id]){var iframe=ssp.getBannerIframe(id);var admedium=ssp.admedia[id];var visible_total=admedium.visible;var loaded_total=ssp.products_loaded[id].length;var hidden_total=loaded_total-visible_total;var last_target=fx.cycle_products_last_target[id];var target=last_target;var source;var hover=true;var ad_id='sonar-admedium-'+id+'-banner-item-';while((target===last_target||hover===true)&&visible_total!==1){target=Math.floor(Math.random()*visible_total);var i=ssp.products_loaded[id][target];var banner_id=ad_id+i;var p=iframe.getElementById(banner_id);if(ssp.getStyleValue(id,p,'font-family')==='hover'){hover=true}else{hover=false}if(hover===true&&visible_total<=2){target=last_target;break}}var item_id=ad_id+ssp.products_loaded[id][target];var item=iframe.getElementById(item_id);if(ssp.getStyleValue(id,item,'font-family')==='hover'&&visible_total===1){item.onmouseout=function(){item.onmouseout='';if(fx.cycle_products[id]){fx.cycle_products_last_target[id]=target;source=(Math.floor(Math.random()*hidden_total)+parseInt(visible_total,10));fx.hideProduct(id,target,source)}}}else{fx.cycle_products_last_target[id]=target;source=(Math.floor(Math.random()*hidden_total)+parseInt(visible_total,10));fx.hideProduct(id,target,source)}}},hideProduct:function(id,target,source){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var fx=ssp.fx;var i=ssp.products_loaded[id][target];var item_id='sonar-admedium-'+id+'-banner-item-'+i;var callback=function(){fx.switchProducts(id,target,source)};fx.fade(id,item_id,-1,0,callback)},fade:function(admedium_id,id,direction,end,callback){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var fx=ssp.fx;var iframe=ssp.getBannerIframe(admedium_id);var elem=iframe.getElementById(id);var alpha=direction===1?0:100;var timer=setInterval(function(){try{if(alpha===end){clearInterval(timer);if(typeof callback==='function'){callback()}if(alpha===100){elem.style.filter=''}}else{var value=Math.round(alpha+((end-alpha)*0.05))+(1*direction);elem.style.opacity=value/100;elem.style.filter='alpha(opacity='+value+')';alpha=value}}catch(e){clearInterval(timer)}},fx.fade_interval)},switchProducts:function(id,target,source){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var fx=ssp.fx;var ad_id='sonar-admedium-'+id+'-banner-item-';var iframe=ssp.getBannerIframe(id);var target_item_i=ssp.products_loaded[id][target];var source_item_i=ssp.products_loaded[id][source];var target_item_id=ad_id+target_item_i;var source_item_id=ad_id+source_item_i;var target_item=iframe.getElementById(target_item_id);var source_item=iframe.getElementById(source_item_id);var target_href=target_item.href;var source_href=source_item.href;var target_onclick=target_item.onclick;var source_onclick=source_item.onclick;var removedNodes=[];var removedNode;while(target_item.childNodes.length>=1){removedNode=target_item.removeChild(target_item.firstChild);removedNodes.push(removedNode)}target_item.href=source_href;target_item.onclick=source_onclick;source_item.href=target_href;source_item.onclick=target_onclick;while(source_item.childNodes.length>=1){removedNode=source_item.removeChild(source_item.firstChild);target_item.appendChild(removedNode)}for(var i in removedNodes){if(removedNodes.hasOwnProperty(i)){source_item.appendChild(removedNodes[i])}}fx.fade(id,target_item_id,1,100,fx.resumeCycleProducts(id))},resumeCycleProducts:function(id){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var core=ssp.core;var fx=ssp.fx;core.safeTimeout(function(){fx.cycleProducts(id)},fx.cycle_products_timeout_length)},countDownInit:function(id,i,valid,enableDays){var ad_id='sonar-admedium-'+id;var ssp=sociomantic.sonar.ssp['rubicon-eu'];var fx=ssp.fx;var iframe=ssp.getBannerIframe(id);var banner_id=ad_id+'-products';var banner=iframe.getElementById(banner_id);var items=banner.childNodes;var item_id=ad_id+'-banner-item-'+i;if(items.length>0){for(var j=0;j<items.length;j++){if(items[j]['id']===item_id){fx.buildCountDown(id,i,valid,enableDays)}}}},buildCountDown:function(id,i,valid,enableDays){var ad_id='sonar-admedium-'+id;var ssp=sociomantic.sonar.ssp['rubicon-eu'];var fx=ssp.fx;var iframe=ssp.getBannerIframe(id);var item_id=ad_id+'-banner-item-'+i;var item=iframe.getElementById(item_id);var container=iframe.createElement('span');var hours=iframe.createElement('span');var mins=iframe.createElement('span');var secs=iframe.createElement('span');hours.id=item_id+'-fx-countdown-hours';mins.id=item_id+'-fx-countdown-mins';secs.id=item_id+'-fx-countdown-secs';hours.className='fx-countdown-hours';mins.className='fx-countdown-mins';secs.className='fx-countdown-secs';container.className='fx-countdown';item.appendChild(container);if(enableDays){var days=iframe.createElement('span');days.id=item_id+'-fx-countdown-days';days.className='fx-countdown-days';container.appendChild(days);fx.addCountDownSeparator(ssp,iframe,container,'-days-to-hrs')}container.appendChild(hours);fx.addCountDownSeparator(ssp,iframe,container,'-hrs-to-mins');container.appendChild(mins);fx.addCountDownSeparator(ssp,iframe,container,'-mins-to-secs');container.appendChild(secs);fx.calculateCountDown(id,i,valid,enableDays)},addCountDownSeparator:function(ssp,doc,parent,classPostfix){var separator=':';var element=doc.createElement('span');var baseClass='fx-countdown-separator';ssp.addCssClass(element,baseClass);ssp.addCssClass(element,baseClass+classPostfix);element.innerHTML=separator;parent.appendChild(element)},resumeCountDown:function(id,i,valid,enableDays){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var core=ssp.core;var fx=ssp.fx;core.safeTimeout(function(){fx.countDown(id,i,valid,enableDays)},fx.count_down_timeout_length)},countDown:function(id,i,valid,enableDays){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var fx=ssp.fx;if(fx.count_down_products[id]){fx.calculateCountDown(id,i,valid,enableDays)}},calculateCountDown:function(id,i,valid,enableDays){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var fx=ssp.fx;var currentTime=Math.round((new Date()).getTime()/1000);var timeLeft=parseInt(valid,10)-currentTime;var days=0;var hours=0;var mins=0;var secs=0;if(timeLeft>0){secs=Math.round(timeLeft%60);mins=Math.round(((timeLeft-secs)%3600)/60);if(enableDays){hours=Math.round(((timeLeft-mins*60-secs)%86400)/3600);days=Math.round((timeLeft-hours*3600-mins*60-secs)/86400);if(days<1){days=0}}else{hours=Math.round((timeLeft-mins*60-secs)/3600)}if(secs<1){secs=0}if(mins<1){mins=0}if(hours<1){hours=0}fx.resumeCountDown(id,i,valid,enableDays)}fx.updateCountDown(id,i,hours,mins,secs,enableDays,days)},updateCountDown:function(id,i,hours,mins,secs,enableDays,days){var item_id='sonar-admedium-'+id+'-banner-item-'+i;var ssp=sociomantic.sonar.ssp['rubicon-eu'];var iframe=ssp.getBannerIframe(id);var hours_id=item_id+'-fx-countdown-hours';var mins_id=item_id+'-fx-countdown-mins';var secs_id=item_id+'-fx-countdown-secs';var hours_span=iframe.getElementById(hours_id);var mins_span=iframe.getElementById(mins_id);var secs_span=iframe.getElementById(secs_id);if(hours_span&&mins_span&&secs_span){hours=hours<10?'0'+hours:hours;mins=mins<10?'0'+mins:mins;secs=secs<10?'0'+secs:secs;hours_span.innerHTML=hours;mins_span.innerHTML=mins;secs_span.innerHTML=secs;if(enableDays){var days_id=item_id+'-fx-countdown-days';var days_span=iframe.getElementById(days_id);days_span.innerHTML=days;if(days===0){ssp.addCssClass(days_span,'metadata-zero-days')}}}},billboardInit:function(id,billboardFirst){var fx=sociomantic.sonar.ssp['rubicon-eu'].fx;if(typeof fx.billboards[id]==='undefined'){fx.billboards[id]=new fx.billboard(id);fx.billboards[id].init(billboardFirst)}},billboard:function(id){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var core=ssp.core;var fx=ssp.fx;var ad_id='sonar-admedium-'+id;var iframe=ssp.getBannerIframe(id);var banner=iframe.getElementById(ad_id+'-banner');var billboard=iframe.createElement('a');var slug=iframe.createElement('span');var slug_z_index_back='-999';var slug_z_index_front='999';var fade=fx.fade;var timeout=fx.billboard_timeout_length;var tween_timeout=200;var z_index_back='-1000';var z_index_front='1000';billboard.className='billboard';billboard.id=ad_id+'-billboard';slug.className='slug';slug.id=ad_id+'-slug';billboard.onmouseout=function(){if(fx.billboards[id]&&fx.billboards[id].hovered){fx.billboards[id].hovered=false;if(fx.billboards[id].waiting){fx.billboards[id].hide()}}};billboard.onmouseover=function(){if(ssp.getStyleValue(id,billboard,'font-family')==='hover'){fx.billboards[id].hovered=true}};return{enabled:true,hovered:false,waiting:false,init:function(billboardFirst){fx.billboards[id].build(billboardFirst);if(billboardFirst){timeout=fx.billboard_first_timeout_length}else{timeout=fx.billboard_timeout_length}core.safeTimeout(function(){if(billboardFirst){fx.billboards[id].hide()}else{fx.billboards[id].show()}},timeout)},build:function(billboardFirst){var admedium=ssp.admedia[id];var url=admedium.logoUrl;var opacity;ssp.createClickLink(billboard,url,'billboard.build');if(fx.billboards[id].enabled&&billboardFirst){opacity=100;billboard.style.zIndex=z_index_front;slug.style.zIndex=slug_z_index_front}else{opacity=0;billboard.style.zIndex=z_index_back;slug.style.zIndex=slug_z_index_back}billboard.style.opacity=opacity;slug.style.opacity=opacity;billboard.style.filter='alpha(opacity='+opacity+')';slug.style.filter='alpha(opacity='+opacity+')';banner.appendChild(billboard);banner.appendChild(slug)},show:function(){if(fx.billboards[id].enabled){billboard.style.zIndex=z_index_front;slug.style.zIndex=slug_z_index_front;var callback=function(){core.safeTimeout(function(){fx.billboards[id].hide()},timeout)};core.safeTimeout(function(){fade(id,billboard.id,1,100,callback)},tween_timeout);fade(id,slug.id,1,100,'')}},hide:function(){if(fx.billboards[id].hovered){fx.billboards[id].waiting=true}else{fx.billboards[id].waiting=false;var callback=function(){billboard.style.zIndex=z_index_back;slug.style.zIndex=slug_z_index_back;core.safeTimeout(function(){fx.billboards[id].show()},timeout)};fade(id,billboard.id,-1,0,callback);core.safeTimeout(function(){fade(id,slug.id,-1,0,'')},tween_timeout)}}}}};sociomantic.sonar.ssp['rubicon-eu'].core.location.sonar='eu-sonar.sociomantic.com/js/2010-07-01/';sociomantic.sonar.ssp['rubicon-eu'].core.location.debug='eu-dbug.sociomantic.com/ssp/debug.gif?';sociomantic.sonar.ssp['rubicon-eu'].core.location.trace='eu-dbug.sociomantic.com/ssp/trace.gif?';sociomantic.sonar.ssp['rubicon-eu'].targeting_hosts=['eu-jet-01.sociomantic.com/js/2010-07-01/','eu-jet-02.sociomantic.com/js/2010-07-01/'];sociomantic.sonar.ssp['rubicon-eu'].static_host='eu-static';sociomantic.sonar.ssp['rubicon-eu'].static_servers=[1,2,3,4,5,6,7,8,9];sociomantic.sonar.ssp['rubicon-eu'].admedium_request_timeout_length=1000;sociomantic.sonar.ssp['rubicon-eu'].view_request_timeout_length=2000;sociomantic.sonar.ssp['rubicon-eu'].redisplayBanner=function(id){var ssp=sociomantic.sonar.ssp['rubicon-eu'];var admedium=ssp.admedia[id];ssp.clearBanner(id);ssp.displayBanner(id,'onloadBannerIframe')};sociomantic.sonar.ssp['rubicon-eu'].displayDefaultBanner=function(id){var u='undefined';var ssp=sociomantic.sonar.ssp['rubicon-eu'];var admedium=ssp.admedia[id];var ao={'1':[{id:'13444',fsize:1,type:1,url:'http://www.sociomantic.com/solutions/?utm_source=rtb&utm_medium=display&utm_campaign=retargeting-programmatic&utm_term=EN',currency:'AED',price:'0.00',sprice:'0.00',createtime:1413878290,ftype:1}],'3':[{id:'13453',fsize:3,type:1,url:'http://www.sociomantic.com/solutions/?utm_source=rtb&utm_medium=display&utm_campaign=retargeting-programmatic&utm_term=EN',currency:'AED',price:'0.00',sprice:'0.00',createtime:1413878290,ftype:1}],'4':[{id:'13446',fsize:4,type:1,url:'http://www.sociomantic.com/solutions/?utm_source=rtb&utm_medium=display&utm_campaign=retargeting-programmatic&utm_term=EN',currency:'AED',price:'0.00',sprice:'0.00',createtime:1413878290,ftype:1}],'5':[{id:'13447',fsize:5,type:1,url:'http://www.sociomantic.com/solutions/?utm_source=rtb&utm_medium=display&utm_campaign=retargeting-programmatic&utm_term=EN',currency:'AED',price:'0.00',sprice:'0.00',createtime:1413878290,ftype:1}],'8':[{id:'13448',fsize:8,type:1,url:'http://www.sociomantic.com/solutions/?utm_source=rtb&utm_medium=display&utm_campaign=retargeting-programmatic&utm_term=EN',currency:'AED',price:'0.00',sprice:'0.00',createtime:1413878290,ftype:1}],'9':[{id:'13455',fsize:9,type:1,url:'http://www.sociomantic.com/solutions/?utm_source=rtb&utm_medium=display&utm_campaign=retargeting-programmatic&utm_term=EN',currency:'AED',price:'0.00',sprice:'0.00',createtime:1413878290,ftype:1}],'10':[{id:'13449',fsize:10,type:1,url:'http://www.sociomantic.com/solutions/?utm_source=rtb&utm_medium=display&utm_campaign=retargeting-programmatic&utm_term=EN',currency:'AED',price:'0.00',sprice:'0.00',createtime:1413878290,ftype:1}],'13':[{id:'13445',fsize:13,type:1,url:'http://www.sociomantic.com/solutions/?utm_source=rtb&utm_medium=display&utm_campaign=retargeting-programmatic&utm_term=EN',currency:'AED',price:'0.00',sprice:'0.00',createtime:1413878290,ftype:1}],'18':[{id:'13450',fsize:18,type:1,url:'http://www.sociomantic.com/solutions/?utm_source=rtb&utm_medium=display&utm_campaign=retargeting-programmatic&utm_term=EN',currency:'AED',price:'0.00',sprice:'0.00',createtime:1413878290,ftype:1}],'60':[{id:'13451',fsize:60,type:1,url:'http://www.sociomantic.com/solutions/?utm_source=rtb&utm_medium=display&utm_campaign=retargeting-programmatic&utm_term=EN',currency:'AED',price:'0.00',sprice:'0.00',createtime:1413878290,ftype:1}],'62':[],'63':[],'67':[{id:'13457',fsize:67,type:1,url:'http://www.sociomantic.com/solutions/?utm_source=rtb&utm_medium=display&utm_campaign=retargeting-programmatic&utm_term=EN',currency:'AED',price:'0.00',sprice:'0.00',createtime:1413878491,ftype:1}],'68':[{id:'13458',fsize:68,type:1,url:'http://www.sociomantic.com/solutions/?utm_source=rtb&utm_medium=display&utm_campaign=retargeting-programmatic&utm_term=EN',currency:'AED',price:'0.00',sprice:'0.00',createtime:1413878491,ftype:1}],'69':[{id:'13459',fsize:69,type:1,url:'http://www.sociomantic.com/solutions/?utm_source=rtb&utm_medium=display&utm_campaign=retargeting-programmatic&utm_term=EN',currency:'AED',price:'0.00',sprice:'0.00',createtime:1413878491,ftype:1}],'70':[{id:'13481',fsize:70,type:1,url:'http://www.sociomantic.com/solutions/?utm_source=rtb&utm_medium=display&utm_campaign=retargeting-programmatic&utm_term=EN',currency:'AED',price:'0.00',sprice:'0.00',createtime:1413889384,ftype:1}],'71':[{id:'13480',fsize:71,type:1,url:'http://www.sociomantic.com/solutions/?utm_source=rtb&utm_medium=display&utm_campaign=retargeting-programmatic&utm_term=EN',currency:'AED',price:'0.00',sprice:'0.00',createtime:1413889384,ftype:1}]};admedium.ao=ao[admedium.size];admedium.aaid_fallback=typeof ssp.admedia[id]['aaid']!==u?ssp.admedia[id]['aaid']:'13222538177062484705';admedium.aaid='13222538177062484705';admedium.cid_fallback=1733;admedium.cid_failed=typeof admedium.cid!==u?admedium.cid:1733;admedium.cid=typeof admedium.cid!==u?admedium.cid:1733;admedium.gid=typeof admedium.gid!==u?admedium.gid:3372;admedium.gid_fallback=3372;admedium.c2a='';admedium.ccs=0;admedium.cfmt=0;admedium.url='http://www.sociomantic.com/solutions/?utm_source=rtb&utm_medium=display&utm_campaign=retargeting-programmatic&utm_term=EN';admedium.click_url='';admedium.click_code='';admedium.view_url='';admedium.visible=1;ssp.redisplayBanner(id)};sociomantic.sonar.ssp['rubicon-eu'].fallback=sociomantic.sonar.ssp['rubicon-eu'].displayDefaultBanner;try{sociomantic.enable()}catch(e){sociomantic.sonar['ssp']['rubicon-eu'].core.reportError(e,'initial_sociomantic_enable')}